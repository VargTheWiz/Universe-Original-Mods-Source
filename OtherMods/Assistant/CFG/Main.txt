ML ^{
    GameMenu ^{
        Panel ^{
            Panel ^{
                Assistant ^{
                    Panel ^{
                        Active=True
                        GraphButton ^{
                            ImageDown=GI,Bm.FormAst.2SwitchRightD
                            ImageNormal=GI,Bm.FormAst.2SwitchRightN
                            ImageNormalA=GI,Bm.FormAst.2SwitchRightA
                            Kind=Normal
                            KindHit=Rect
                            MouseBlocking=True
                            MouseBlockingTest=False
                            Name=AstToTablet
                            OnPressCode ^{
                                01=InterfaceState('StarMap', 'AstPanel', 1);
                                02=InterfaceState('StarMap', 'AstPanelTablet', 1);
                                03=InterfaceState('StarMap', 'Assist_panel_move_button', 1);
                                04=InterfaceState('GameMenu', 'AstSwitchTablet', 1);
                                05=InterfaceState('GameMenu', 'AstSwitchDesktop', 0);
                            }
                            Pos=96,14,1
                            Size=17,30
                            Style=Style.GB.SoundNormal
                        }
                        Image ^{
                            Image=GI,Bm.FormAst.2SwitchLeftH
                            Pos=6,14,1
                            Size=17,30
                        }
                        Image ^{
                            Image=GI,Bm.FormAst.2AstSwitcher
                            Pos=0,0,2
                            Size=126,54
                        }
                        Label ^{
                            AlignX=Center
                            AlignY=CenterEx
                            Font=Font.2Ranger
                            Pos=25,13,-1
                            Size=70,32
                            Text=Assistant OFF
                            TextColor=0,26,49
                            TextShadow=1
                            TextShadowColor=0,135,192
                            WordWrap=True
                        }
                        Name=AstSwitchDesktop
                        Pos=166,393,-10
                        Size=126,54
                    }
                    Panel ^{
                        Active=False
                        GraphButton ^{
                            ImageDown=GI,Bm.FormAst.2SwitchLeftD
                            ImageNormal=GI,Bm.FormAst.2SwitchLeftN
                            ImageNormalA=GI,Bm.FormAst.2SwitchLeftA
                            Kind=Normal
                            KindHit=Rect
                            MouseBlocking=True
                            MouseBlockingTest=False
                            Name=AstToDesktop
                            OnPressCode ^{
                                01=InterfaceState('StarMap', 'AstPanel', 1);
                                02=InterfaceState('StarMap', 'AstPanelTablet', 0);
                                03=InterfaceState('StarMap', 'Assist_panel_move_button', 0);
                                04=InterfaceState('GameMenu', 'AstSwitchTablet', 0);
                                05=InterfaceState('GameMenu', 'AstSwitchDesktop', 1);
                            }
                            Pos=6,14,1
                            Size=17,30
                            Style=Style.GB.SoundNormal
                        }
                        Image ^{
                            Image=GI,Bm.FormAst.2SwitchRightH
                            Pos=96,14,1
                            Size=17,30
                        }
                        Image ^{
                            Image=GI,Bm.FormAst.2AstSwitcher
                            Pos=0,0,2
                            Size=126,54
                        }
                        Label ^{
                            AlignX=Center
                            AlignY=CenterEx
                            Font=Font.2Ranger
                            Pos=25,13,-1
                            Size=70,32
                            Text=Assistant ON
                            TextColor=0,26,49
                            TextShadow=1
                            TextShadowColor=0,135,192
                            WordWrap=True
                        }
                        Name=AstSwitchTablet
                        Pos=166,393,-10
                        Size=126,54
                    }
                }
                Image ^{
                    Image=GI,Bm.FormAst.2Ast_BG_new
                    Pos=0,0,9
                    Size=451,447
                }
                Size=451,447
            }
        }
    }
    Planet ^{
        Panel ^{
            Panel ^{
                Assistant ^{
                    Panel ^{
                        GraphButton ^{
                            ImageDown=GI,Bm.FormAst.2AstAddMM_D
                            ImageNormal=GI,Bm.FormAst.2AstAddMM_N
                            ImageNormalA=GI,Bm.FormAst.2AstAddMM_A
                            Kind=Normal
                            KindHit=Graph
                            Name=AstPlanetChain
                            OnPressCode ^{
                                01=int i, k, l, m, j, n, bon, may_add_end, c_ruin, may_add;
                                02=dword ruin, item, star;
                                03=str mm_name_color, mm_color, mm_name, mm_text;
                                04=str br = substr(CT('FormScore.DateWin'), 5, 2);
                                05=unknown mm_array = newarray(1);
                                06=unknown ruin_array_name = newarray(1);
                                07=unknown ruin_array = newarray(1);
                                08=unknown mm_array_1 = newarray(1);
                                09=unknown mm_array_2 = newarray(1);
                                10=unknown mm_array_3 = newarray(1);
                                11=for(i = 0; i < GalaxyStars(); i = i + 1)
                                12 ^{
                                    01=star = StarNearbyStars(ShipStar(Player()), i);
                                    02=if(StarOwner(star) != 0 && StarOwner(star) != 2) continue;
                                    03=if(StarCustomFaction(star) != '') continue;
                                    04=for(j = 0; j < StarRuins(star); j = j + 1)
                                    05 ^{
                                        01=ruin = StarRuins(star, j);
                                        02=if(ShipType(ruin) != 'RC' && (ShipType(ruin) != 'CB' || !IsScriptActive('Mod_ExpCB'))) continue;
                                        03=mm_text = ruin + ' (' + Name(star) + ')';
                                        04=ArrayAdd(ruin_array, ruin);
                                        05=if(ShipTypeN(ruin) == t_RC) ArrayAdd(ruin_array_name, 'RC ' + ShipName(ruin) + ' (' + Name(star) + ')');
                                        06=else ArrayAdd(ruin_array_name, 'dom. ' + ShipName(ruin) + ' (' + Name(star) + ')');
                                    }
                                }
                                13=ruin = 0;
                                14=if(ArrayDim(ruin_array) > 1)
                                15 ^{
                                    01=if(ArrayDim(ruin_array) > 2)
                                    02 ^{
                                        01=ArrayAdd(ruin_array_name, 'Information for all (main.)');
                                        02=ArrayAdd(ruin_array_name, 'Information for all (alternative.)');
                                    }
                                    03=if(ArrayDim(ruin_array) == 2)
                                    04 ^{
                                        01=ArrayAdd(ruin_array_name, 'Alternative chain');
                                    }
                                    05=c_ruin = ListBox('Chain stations:', ruin_array_name);
                                    06=if(c_ruin > 0)
                                    07 ^{
                                        01=if(c_ruin < ArrayDim(ruin_array))
                                        02 ^{
                                            01=ruin = ruin_array[c_ruin];
                                            02=ArrayClear(ruin_array);
                                            03=ArrayAdd(ruin_array, ruin);
                                            04=ruin = 100;
                                        }
                                        02=else
                                        03 ^{
                                            01=if(ArrayDim(ruin_array) > 2)
                                            02 ^{
                                                01=if(c_ruin - ArrayDim(ruin_array) == 0) ruin = 100;
                                                02=if(c_ruin - ArrayDim(ruin_array) == 1) ruin = 101;
                                                03=if(c_ruin - ArrayDim(ruin_array) == 2) ruin = 102;
                                            }
                                            03=else if(ArrayDim(ruin_array) == 2)
                                            04 ^{
                                                01=if(c_ruin - ArrayDim(ruin_array) == 0) ruin = 101;
                                                02=if(c_ruin - ArrayDim(ruin_array) == 1) ruin = 102;
                                            }
                                        }
                                    }
                                }
                                16=if(ArrayDim(ruin_array) == 1) MessageBox('No matching stations found.');
                                17=if(ArrayDim(ruin_array) == 1 || c_ruin < 0) exit;
                                18=for(i = 0; i < ShipItems(Player()); i = i + 1)
                                19 ^{
                                    01=item = ShipItems(Player(), i);
                                    02=if(ItemType(item) != t_MicroModule) continue;
                                    03=if(BonusIsSpecial(EqModule(item))) continue;
                                    04=l = 0;
                                    05=for(j = 1; j < ArrayDim(mm_array); j = j + 1)
                                    06 ^{
                                        01=if(EqModule(item) != mm_array[j])
                                        02 ^{
                                            01=l = 1;
                                            02=break;
                                        }
                                    }
                                    07=if(ArrayDim(mm_array) == 1) ArrayAdd(mm_array, EqModule(item));
                                    08=if(l) ArrayAdd(mm_array, EqModule(item));
                                }
                                20=if(ruin == 100)
                                21 ^{
                                    01=for(m = 1; m < ArrayDim(ruin_array); m = m + 1)
                                    02 ^{
                                        01=ruin = ruin_array[m];
                                        02=ArrayClear(mm_array_1);
                                        03=ArrayClear(mm_array_2);
                                        04=ArrayClear(mm_array_3);
                                        05=for(i = 0; i <= 2; i = i + 1)
                                        06 ^{
                                            01=if(i == 2) mm_color = '<color=255,0,0>';
                                            02=else if(i == 1) mm_color = '<color=255,240,100>';
                                            03=else mm_color = '<color=17,139,255>';
                                            04=mm_text = '';
                                            05=may_add_end = 0;
                                            06=l = 0;
                                            07=while(l <= 50)
                                            08 ^{
                                                01=may_add = 0;
                                                02=for(n = 0; n < ShipItems(Player()); n = n + 1)
                                                03 ^{
                                                    01=item = ShipItems(Player(), n);
                                                    02=bon = RuinsMicromoduleChain(ruin, i, l);
                                                    03=if(ItemType(item) < t_Hull) continue;
                                                    04=if(ItemType(item) > t_CustomWeapon) continue;
                                                    05=if(~EqModule(item)) continue;
                                                    06=if(MayAddBonusToEq(bon, item))
                                                    07 ^{
                                                        01=may_add = 1;
                                                        02=break;
                                                    }
                                                }
                                                04=for(k = 1; k < ArrayDim(mm_array); k = k + 1)
                                                05 ^{
                                                    01=if(mm_array[k] == bon) may_add = 0;
                                                }
                                                06=if(may_add || (l == 50 && !may_add_end))
                                                07 ^{
                                                    01=mm_name_color = mm_color;
                                                    02=may_add_end = 1;
                                                }
                                                08=else mm_name_color = '<color=123,123,123>';
                                                09=mm_name = mm_name_color + BonusName(bon) + '</color>';
                                                10=if(i == 2) ArrayAdd(mm_array_1, mm_name);
                                                11=else if(i == 1) ArrayAdd(mm_array_2, mm_name);
                                                12=else ArrayAdd(mm_array_3, mm_name);
                                                13=l = l + 1;
                                            }
                                        }
                                        07=if(ShipTypeN(ruin) == t_RC) mm_text = '<td=50>Micromodules in the main chain <color=255,240,100>RC ' + ShipName(ruin) + '</color>' + br;
                                        08=else mm_text = '<td=38>Micromodules in the main chain <color=255,240,100>dominion ' + ShipName(ruin) + '</color>' + br;
                                        09=mm_text = mm_text + '--------------------------------------------------------------------------------------------------' + br;
                                        10=for(i = 1; i <= 48; i = i + 1)
                                        11 ^{
                                            01=if(i <= 9) mm_text = mm_text + '<td=18>' + i + '. ' + mm_array_1[i] + '<td=178>' + i + '. ' + mm_array_2[i] + '</td>' + '<td=328>' + i + '. ' + mm_array_3[i] + br;
                                            02=else mm_text = mm_text + '<td=10>' + i + '. ' + mm_array_1[i] + '<td=170>' + i + '. ' + mm_array_2[i] + '</td>' + '<td=320>' + i + '. ' + mm_array_3[i] + br;
                                        }
                                        12=Ether(7, '', mm_text);
                                    }
                                }
                                22=else if(ruin == 101)
                                23 ^{
                                    01=for(m = 1; m < ArrayDim(ruin_array); m = m + 1)
                                    02 ^{
                                        01=ruin = ruin_array[m];
                                        02=ArrayClear(mm_array_1);
                                        03=ArrayClear(mm_array_2);
                                        04=for(i = 0; i <= 1; i = i + 1)
                                        05 ^{
                                            01=mm_text = '';
                                            02=l = 0;
                                            03=while(l <= 50)
                                            04 ^{
                                                01=may_add = 0;
                                                02=for(n = 0; n < ShipItems(Player()); n = n + 1)
                                                03 ^{
                                                    01=item = ShipItems(Player(), n);
                                                    02=bon = RuinsMicromoduleChain(ruin, 2, l, i);
                                                    03=if(ItemType(item) < t_Hull) continue;
                                                    04=if(ItemType(item) > t_CustomWeapon) continue;
                                                    05=if(~EqModule(item)) continue;
                                                    06=if(MayAddBonusToEq(bon, item))
                                                    07 ^{
                                                        01=may_add = 1;
                                                        02=break;
                                                    }
                                                }
                                                04=for(k = 1; k < ArrayDim(mm_array); k = k + 1)
                                                05 ^{
                                                    01=if(mm_array[k] == bon) may_add = 0;
                                                }
                                                06=if(may_add || (l == 50 && !may_add_end))
                                                07 ^{
                                                    01=if(i) mm_name_color = '<color=255,0,0>';
                                                    02=else mm_name_color = '<color=195,55,55>';
                                                    03=may_add_end = 1;
                                                }
                                                08=else mm_name_color = '<color=123,123,123>';
                                                09=mm_name = mm_name_color + BonusName(bon) + '</color>';
                                                10=if(i) ArrayAdd(mm_array_2, mm_name);
                                                11=else ArrayAdd(mm_array_1, mm_name);
                                                12=l = l + 1;
                                            }
                                        }
                                        06=if(ShipTypeN(ruin) == t_RC) mm_text = '<td=30>Micromodules in an alternative chain on <color=255,240,100>RC ' + ShipName(ruin) + '</color>' + br;
                                        07=else mm_text = '<td=18>Micromodules in an alternative chain on <color=255,240,100>dominion ' + ShipName(ruin) + '</color>' + br;
                                        08=mm_text = mm_text + '--------------------------------------------------------------------------------------------------' + br;
                                        09=for(i = 1; i <= 48; i = i + 1)
                                        10 ^{
                                            01=if(i <= 9) mm_text = mm_text + '<td=18>' + i + '. ' + mm_array_2[i] + '<td=170>' + ' <color=123,123,123>(' + mm_array_1[i] + ')</color>' + br;
                                            02=else mm_text = mm_text + '<td=10>' + i + '. ' + mm_array_2[i] + '<td=170>' + ' <color=123,123,123>(' + mm_array_1[i] + ')</color>' + br;
                                        }
                                        11=Ether(7, ruin + '-12345-54321-ALT', mm_text);
                                    }
                                }
                                24=FormChange('Planet');
                            }
                            Pos=15,15,0
                            Size=35,33
                            Style=Style.GB.SoundNormal
                        }
                        GraphButton ^{
                            ImageDown=GI,Bm.FormAst.2AstAddTurnD
                            ImageNormal=GI,Bm.FormAst.2AstAddTurnN
                            ImageNormalA=GI,Bm.FormAst.2AstAddTurnA
                            Kind=Normal
                            KindHit=Graph
                            Name=AstPlanetTurn
                            OnPressCode ^{
                                01=if(IsFilm()) exit;
                                02=if(StarBattle(ShipStar(Player())))
                                03 ^{
                                    01=MessageBox('There are military operations in the system, it is impossible to skip turns!', 2+32);
                                    02=exit;
                                }
                                04=int turn_left = TextBox('How many turns to skip?');
                                05=if(turn_left <= 0) exit;
                                06=dword cur_star = ShipStar(Player());
                                07=for(int i = 0; i < turn_left; i = i + 1)
                                08 ^{
                                    01=if(StarBattle(cur_star))
                                    02 ^{
                                        01=MessageBox('Combat actions have begun in the system, further skipping is impossible!', 2+32);
                                        02=exit;
                                    }
                                    03=ButtonClick('Planet', 'PM_EndTurn');
                                }
                            }
                            Pos=15,51,0
                            Size=35,33
                            Style=Style.GB.SoundNormal
                        }
                        Image ^{
                            Image=GI,Bm.FormAst.2AstAddition
                            Pos=0,0,2
                            Size=57,100
                        }
                        Name=AstAddPlanet
                        Pos=967,541,-10
                        PosAutoCorrection=True
                        PosAutoCorrectionXCoef=1
                        PosAutoCorrectionYCoef=1
                        Size=57,100
                    }
                }
            }
        }
    }
    PlanetNO ^{
        Panel ^{
            Panel ^{
                Assistant ^{
                    Panel ^{
                        GraphButton ^{
                            ImageDown=GI,Bm.FormAst.2AstAddMM_D
                            ImageNormal=GI,Bm.FormAst.2AstAddMM_N
                            ImageNormalA=GI,Bm.FormAst.2AstAddMM_A
                            Kind=Normal
                            KindHit=Graph
                            Name=AstPlanetNOChain
                            OnPressCode ^{
                                01=int i, k, l, m, j, n, bon, may_add_end, c_ruin, may_add;
                                02=dword ruin, item, star;
                                03=str mm_name_color, mm_color, mm_name, mm_text;
                                04=str br = substr(CT('FormScore.DateWin'), 5, 2);
                                05=unknown mm_array = newarray(1);
                                06=unknown ruin_array_name = newarray(1);
                                07=unknown ruin_array = newarray(1);
                                08=unknown mm_array_1 = newarray(1);
                                09=unknown mm_array_2 = newarray(1);
                                10=unknown mm_array_3 = newarray(1);
                                11=for(i = 0; i < GalaxyStars(); i = i + 1)
                                12 ^{
                                    01=star = StarNearbyStars(ShipStar(Player()), i);
                                    02=if(StarOwner(star) != 0 && StarOwner(star) != 2) continue;
                                    03=if(StarCustomFaction(star) != '') continue;
                                    04=for(j = 0; j < StarRuins(star); j = j + 1)
                                    05 ^{
                                        01=ruin = StarRuins(star, j);
                                        02=if(ShipType(ruin) != 'RC' && (ShipType(ruin) != 'CB' || !IsScriptActive('Mod_ExpCB'))) continue;
                                        03=mm_text = ruin + ' (' + Name(star) + ')';
                                        04=ArrayAdd(ruin_array, ruin);
                                        05=if(ShipTypeN(ruin) == t_RC) ArrayAdd(ruin_array_name, 'RC ' + ShipName(ruin) + ' (' + Name(star) + ')');
                                        06=else ArrayAdd(ruin_array_name, 'dom. ' + ShipName(ruin) + ' (' + Name(star) + ')');
                                    }
                                }
                                13=ruin = 0;
                                14=if(ArrayDim(ruin_array) > 1)
                                15 ^{
                                    01=if(ArrayDim(ruin_array) > 2)
                                    02 ^{
                                        01=ArrayAdd(ruin_array_name, 'Information for all (main.)');
                                        02=ArrayAdd(ruin_array_name, 'Information for all (alternative.)');
                                    }
                                    03=if(ArrayDim(ruin_array) == 2)
                                    04 ^{
                                        01=ArrayAdd(ruin_array_name, 'Alternative chain');
                                    }
                                    05=c_ruin = ListBox('Chain stations:', ruin_array_name);
                                    06=if(c_ruin > 0)
                                    07 ^{
                                        01=if(c_ruin < ArrayDim(ruin_array))
                                        02 ^{
                                            01=ruin = ruin_array[c_ruin];
                                            02=ArrayClear(ruin_array);
                                            03=ArrayAdd(ruin_array, ruin);
                                            04=ruin = 100;
                                        }
                                        02=else
                                        03 ^{
                                            01=if(ArrayDim(ruin_array) > 2)
                                            02 ^{
                                                01=if(c_ruin - ArrayDim(ruin_array) == 0) ruin = 100;
                                                02=if(c_ruin - ArrayDim(ruin_array) == 1) ruin = 101;
                                                03=if(c_ruin - ArrayDim(ruin_array) == 2) ruin = 102;
                                            }
                                            03=else if(ArrayDim(ruin_array) == 2)
                                            04 ^{
                                                01=if(c_ruin - ArrayDim(ruin_array) == 0) ruin = 101;
                                                02=if(c_ruin - ArrayDim(ruin_array) == 1) ruin = 102;
                                            }
                                        }
                                    }
                                }
                                16=if(ArrayDim(ruin_array) == 1) MessageBox('No suitable station found.');
                                17=if(ArrayDim(ruin_array) == 1 || c_ruin < 0) exit;
                                18=for(i = 0; i < ShipItems(Player()); i = i + 1)
                                19 ^{
                                    01=item = ShipItems(Player(), i);
                                    02=if(ItemType(item) != t_MicroModule) continue;
                                    03=if(BonusIsSpecial(EqModule(item))) continue;
                                    04=l = 0;
                                    05=for(j = 1; j < ArrayDim(mm_array); j = j + 1)
                                    06 ^{
                                        01=if(EqModule(item) != mm_array[j])
                                        02 ^{
                                            01=l = 1;
                                            02=break;
                                        }
                                    }
                                    07=if(ArrayDim(mm_array) == 1) ArrayAdd(mm_array, EqModule(item));
                                    08=if(l) ArrayAdd(mm_array, EqModule(item));
                                }
                                20=if(ruin == 100)
                                21 ^{
                                    01=for(m = 1; m < ArrayDim(ruin_array); m = m + 1)
                                    02 ^{
                                        01=ruin = ruin_array[m];
                                        02=ArrayClear(mm_array_1);
                                        03=ArrayClear(mm_array_2);
                                        04=ArrayClear(mm_array_3);
                                        05=for(i = 0; i <= 2; i = i + 1)
                                        06 ^{
                                            01=if(i == 2) mm_color = '<color=255,0,0>';
                                            02=else if(i == 1) mm_color = '<color=255,240,100>';
                                            03=else mm_color = '<color=17,139,255>';
                                            04=mm_text = '';
                                            05=may_add_end = 0;
                                            06=l = 0;
                                            07=while(l <= 50)
                                            08 ^{
                                                01=may_add = 0;
                                                02=for(n = 0; n < ShipItems(Player()); n = n + 1)
                                                03 ^{
                                                    01=item = ShipItems(Player(), n);
                                                    02=bon = RuinsMicromoduleChain(ruin, i, l);
                                                    03=if(ItemType(item) < t_Hull) continue;
                                                    04=if(ItemType(item) > t_CustomWeapon) continue;
                                                    05=if(~EqModule(item)) continue;
                                                    06=if(MayAddBonusToEq(bon, item))
                                                    07 ^{
                                                        01=may_add = 1;
                                                        02=break;
                                                    }
                                                }
                                                04=for(k = 1; k < ArrayDim(mm_array); k = k + 1)
                                                05 ^{
                                                    01=if(mm_array[k] == bon) may_add = 0;
                                                }
                                                06=if(may_add || (l == 50 && !may_add_end))
                                                07 ^{
                                                    01=mm_name_color = mm_color;
                                                    02=may_add_end = 1;
                                                }
                                                08=else mm_name_color = '<color=123,123,123>';
                                                09=mm_name = mm_name_color + BonusName(bon) + '</color>';
                                                10=if(i == 2) ArrayAdd(mm_array_1, mm_name);
                                                11=else if(i == 1) ArrayAdd(mm_array_2, mm_name);
                                                12=else ArrayAdd(mm_array_3, mm_name);
                                                13=l = l + 1;
                                            }
                                        }
                                        07=if(ShipTypeN(ruin) == t_RC) mm_text = '<td=50>Micromodules in the main chain on <color=255,240,100>RC ' + ShipName(ruin) + '</color>' + br;
                                        08=else mm_text = '<td=38>Micromodules in the main chain on <color=255,240,100>dominion ' + ShipName(ruin) + '</color>' + br;
                                        09=mm_text = mm_text + '--------------------------------------------------------------------------------------------------' + br;
                                        10=for(i = 1; i <= 48; i = i + 1)
                                        11 ^{
                                            01=if(i <= 9) mm_text = mm_text + '<td=18>' + i + '. ' + mm_array_1[i] + '<td=178>' + i + '. ' + mm_array_2[i] + '</td>' + '<td=328>' + i + '. ' + mm_array_3[i] + br;
                                            02=else mm_text = mm_text + '<td=10>' + i + '. ' + mm_array_1[i] + '<td=170>' + i + '. ' + mm_array_2[i] + '</td>' + '<td=320>' + i + '. ' + mm_array_3[i] + br;
                                        }
                                        12=Ether(7, '', mm_text);
                                    }
                                }
                                22=else if(ruin == 101)
                                23 ^{
                                    00=for(m = 1; m < ArrayDim(ruin_array); m = m + 1)
                                    01 ^{
                                        01=ruin = ruin_array[m];
                                        02=ArrayClear(mm_array_1);
                                        03=ArrayClear(mm_array_2);
                                        04=for(i = 0; i <= 1; i = i + 1)
                                        05 ^{
                                            01=mm_text = '';
                                            02=l = 0;
                                            03=while(l <= 50)
                                            04 ^{
                                                01=may_add = 0;
                                                02=for(n = 0; n < ShipItems(Player()); n = n + 1)
                                                03 ^{
                                                    01=item = ShipItems(Player(), n);
                                                    02=bon = RuinsMicromoduleChain(ruin, 2, l, i);
                                                    03=if(ItemType(item) < t_Hull) continue;
                                                    04=if(ItemType(item) > t_CustomWeapon) continue;
                                                    05=if(~EqModule(item)) continue;
                                                    06=if(MayAddBonusToEq(bon, item))
                                                    07 ^{
                                                        01=may_add = 1;
                                                        02=break;
                                                    }
                                                }
                                                04=for(k = 1; k < ArrayDim(mm_array); k = k + 1)
                                                05 ^{
                                                    01=if(mm_array[k] == bon) may_add = 0;
                                                }
                                                06=if(may_add || (l == 50 && !may_add_end))
                                                07 ^{
                                                    01=if(i) mm_name_color = '<color=255,0,0>';
                                                    02=else mm_name_color = '<color=195,55,55>';
                                                    03=may_add_end = 1;
                                                }
                                                08=else mm_name_color = '<color=123,123,123>';
                                                09=mm_name = mm_name_color + BonusName(bon) + '</color>';
                                                10=if(i) ArrayAdd(mm_array_2, mm_name);
                                                11=else ArrayAdd(mm_array_1, mm_name);
                                                12=l = l + 1;
                                            }
                                        }
                                        06=if(ShipTypeN(ruin) == t_RC) mm_text = '<td=30>Micromodules in the alternative chain on <color=255,240,100>RC ' + ShipName(ruin) + '</color>' + br;
                                        07=else mm_text = '<td=18>Micromodules in the alternative chain on <color=255,240,100>dominion ' + ShipName(ruin) + '</color>' + br;
                                        08=mm_text = mm_text + '--------------------------------------------------------------------------------------------------' + br;
                                        09=for(i = 1; i <= 48; i = i + 1)
                                        10 ^{
                                            01=if(i <= 9) mm_text = mm_text + '<td=18>' + i + '. ' + mm_array_2[i] + '<td=170>' + ' <color=123,123,123>(' + mm_array_1[i] + ')</color>' + br;
                                            02=else mm_text = mm_text + '<td=10>' + i + '. ' + mm_array_2[i] + '<td=170>' + ' <color=123,123,123>(' + mm_array_1[i] + ')</color>' + br;
                                        }
                                        11=Ether(7, ruin + '-12345-54321-ALT', mm_text);
                                    }
                                }
                                24=FormChange('PlanetNO');
                            }
                            Pos=15,15,0
                            Size=35,33
                            Style=Style.GB.SoundNormal
                        }
                        GraphButton ^{
                            ImageDown=GI,Bm.FormAst.2AstAddTurnD
                            ImageNormal=GI,Bm.FormAst.2AstAddTurnN
                            ImageNormalA=GI,Bm.FormAst.2AstAddTurnA
                            Kind=Normal
                            KindHit=Graph
                            Name=AstPlanetNOTurn
                            OnPressCode ^{
                                01=if(IsFilm()) exit;
                                02=int turn_left = TextBox('How many turns to skip?');
                                03=if(turn_left <= 0) exit;
                                04=for(int i = 0; i < turn_left; i = i + 1)
                                05 ^{
                                    01=ButtonClick('PlanetNO', 'PM_EndTurn');
                                }
                            }
                            Pos=15,51,0
                            Size=35,33
                            Style=Style.GB.SoundNormal
                        }
                        Image ^{
                            Image=GI,Bm.FormAst.2AstAddition
                            Pos=0,0,2
                            Size=57,100
                        }
                        Name=AstAddPlanetNO
                        Pos=967,541,-10
                        PosAutoCorrection=True
                        PosAutoCorrectionXCoef=1
                        PosAutoCorrectionYCoef=1
                        Size=57,100
                    }
                }
            }
        }
    }
    RuinsTalk ^{
        Panel ^{
            Panel ^{
                Assistant ^{
                    Panel ^{
                        GraphButton ^{
                            ImageDisable=GI,Bm.FormAst.2AstAddTurnH
                            ImageDown=GI,Bm.FormAst.2AstAddTurnD
                            ImageNormal=GI,Bm.FormAst.2AstAddTurnN
                            ImageNormalA=GI,Bm.FormAst.2AstAddTurnA
                            Kind=Disable
                            KindHit=Graph
                            Name=AstRuinsTurn
                            OnPressCode ^{
                                01=if(IsFilm()) exit;
                                02=if(StarBattle(ShipStar(Player())))
                                03 ^{
                                    01=MessageBox('The system is in combat, it is impossible to skip a turn!', 2+32);
                                    02=exit;
                                }
                                04=int turn_left = TextBox('How many turns to skip?');
                                05=if(turn_left <= 0) exit;
                                06=dword cur_star = ShipStar(Player());
                                07=for(int i = 0; i < turn_left; i = i + 1)
                                08 ^{
                                    01=if(StarBattle(cur_star))
                                    02 ^{
                                        01=MessageBox('Hostilities have begun in the system, further skipping is impossible!', 2+32);
                                        02=exit;
                                    }
                                    03=ButtonClick('RuinsTalk', 'PM_EndTurn');
                                }
                            }
                            Pos=15,51,0
                            Size=35,33
                            Style=Style.GB.SoundNormal
                        }
                        Image ^{
                            Image=GI,Bm.FormAst.2AstAddition
                            Pos=0,0,2
                            Size=57,100
                        }
                        Image ^{
                            Image=GI,Bm.FormAst.2AstAddMM_N
                            Name=AstRuinsChain
                            OnMouseEnterCode ^{
                                01=dword ruin = GetShipRuins(Player());
                                02=if(!ruin) exit;
                                03=if(ShipType(ruin) != 'RC')
                                04 ^{
                                    01=if(IsScriptActive('Mod_ExpCB'))
                                    02 ^{
                                        01=if(ShipType(ruin) != 'CB') exit;
                                    }
                                    03=else exit;
                                }
                                05=str br = substr(CT('FormScore.DateWin'), 5, 2);
                                06=str MMText, color;
                                07=int MMLevel, alt_chain;
                                08=if(!(CurTurn() % 33)) alt_chain = 1;
                                09=else alt_chain = 0;
                                10=for(int i = 1; i <= 3; i = i + 1)
                                11 ^{
                                    01=if(i == 1)
                                    02 ^{
                                        01=MMLevel = 2;
                                        02=color = '<color=255,0,0>';
                                    }
                                    03=else if(i == 2)
                                    04 ^{
                                        01=MMLevel = 1;
                                        02=color = '<color=255,240,100>';
                                    }
                                    05=else
                                    06 ^{
                                        01=MMLevel = 0;
                                        02=color = '<color=17,139,255>';
                                    }
                                    07=MMText = '';
                                    08=for(int j = 0; j <= 50; j = j + 1)
                                    09 ^{
                                        01=if(j <= 8) MMText = MMText + '<td=7>' + (j + 1) + '. ' + color + BonusName(RuinsMicromoduleChain(ruin, MMLevel, j, alt_chain)) + '</color>' + br;
                                        02=else MMText = MMText + (j + 1) + '. ' + color + BonusName(RuinsMicromoduleChain(ruin, MMLevel, j, alt_chain)) + '</color>' + br;
                                    }
                                    10=InterfaceText('RuinsTalk', 'MM_list_' + MMLevel, MMText);
                                }
                                12=if(ShipTypeN(ruin) == t_RC) InterfaceText('RuinsTalk', 'MM_chain_nameRuin', 'Micromodules in a chain on RC ' + ShipName(ruin));
                                13=else InterfaceText('RuinsTalk', 'MM_chain_nameRuin', 'Micromodules in a chain on dominion ' + ShipName(ruin));
                                14=InterfaceState('RuinsTalk', 'MM_chain_window', 1);
                            }
                            OnMouseLeaveCode ^{
                                01=InterfaceState('RuinsTalk', 'MM_chain_window', 0);
                            }
                            Pos=15,15,0
                            Size=35,33
                        }
                        Name=AstAddRuins
                        Pos=967,541,-10
                        PosAutoCorrection=True
                        PosAutoCorrectionXCoef=1
                        PosAutoCorrectionYCoef=1
                        Size=57,100
                    }
                    Window ^{
                        Active=False
                        Label ^{
                            AlignX=Left
                            AlignY=CenterEx
                            Font=Font.2SmallBold
                            Name=MM_chain_nameRuin
                            Pos=100,13
                            Size=300,33
                            Text=Micromodules in a chain
                            TextColor=57,239,255
                            WordWrap=True
                        }
                        Label ^{
                            AlignX=Left
                            AlignY=Top
                            Font=Font.2Small
                            Name=MM_list_2
                            Pos=20,60
                            Size=160,614
                            TextColor=255,255,255
                            WordWrap=True
                        }
                        Label ^{
                            AlignX=Left
                            AlignY=Top
                            Font=Font.2Small
                            Name=MM_list_1
                            Pos=180,60
                            Size=160,614
                            TextColor=255,255,255
                            WordWrap=True
                        }
                        Label ^{
                            AlignX=Left
                            AlignY=Top
                            Font=Font.2Small
                            Name=MM_list_0
                            Pos=320,60
                            Size=160,614
                            TextColor=255,255,255
                            WordWrap=True
                        }
                        Name=MM_chain_window
                        Pos=472,6
                        PosAutoCorrection=True
                        PosAutoCorrectionXCoef=1
                        PosAutoCorrectionYCoef=1
                        Size=453,684
                        Style=Style.Window.2Simple
                    }
                }
            }
        }
    }
    Scaner ^{
        Panel ^{
            Assistant ^{
                Panel ^{
                    Active=True
                    Image ^{
                        Image=GI,Bm.FormAst.2AstAddition
                        Pos=0,0,2
                        Size=57,100
                    }
                    Image ^{
                        Image=GI,Bm.FormAst.2AstAddStatsH
                        Name=AstScanerStats
                        Pos=15,15,0
                        Size=35,33
                    }
                    Image ^{
                        Image=GI,Bm.FormAst.2AstAddShotN
                        Name=AstScanerShot
                        OnMouseEnterCode ^{
                            0=dword cur_ship=FormCurShip();
                            0=int move_x=0;
                            0=int move_y=0;
                            0=int add_int=0;
                            1=str text='';
                            1=str cl;
                            1=str c_y='<color=255,240,100>';
                            1=str c_e='</color>';
                            1=str ts='';
                            1=dword item=0;
                            1=int i=0;
                            1=str br=substr(CT('FormScore.DateWin'),5,2);
                            2=if(ShipEqInSlot(cur_ship,t_Hull)>0)
                            2 ^{
                                0=item=ShipEqInSlot(cur_ship,t_Hull);
                                0=if(ItemImprovement(item) || EqModule(item)>=0)cl='<color=0,255,0>';
                                0=if(!ItemImprovement(item) && EqModule(item)<0)cl='<color=255,240,100>';
                                0=InterfaceText('Scaner','name_Hull',ItemFullName(item));
                                0=if(HullSeries(item)>=0 && HullSeries(item)<255)InterfaceText('Scaner','name_Hull',ItemFullName(item)+br+'<color=82,166,255>'+'Series \"'+CT('HullType.'+SeriesNumInCfg(HullSeries(item))+'.Name')+'\"');
                                0=int slot=0;
                                1=text='Hull durability: '+c_y+Hitpoints(cur_ship)+c_e+' ('+c_y+ItemSize(item)+c_e+')'+br+' units, skin blocks up to '+br+cl+GetEquipmentStats(item,0)+c_e+' incoming damage.'+br+' Damage susceptibility:'+br+' E:'+c_y+HullDamageSuspectibility(item,0)+c_e+'%  S:'+c_y+HullDamageSuspectibility(item,1)+c_e+'%  M:'+c_y+HullDamageSuspectibility(item,2)+c_e+'%.';
                                2=InterfaceState('Scaner','w_Hull',1);
                                2=InterfaceText('Scaner','text_Hull',text);
                                2=InterfaceText('Scaner','size_Hull',ItemSize(item));
                                2=InterfaceText('Scaner','cost_Hull',ItemCost(item));
                                3=if(ItemOwner(item)!=5)InterfaceImage('Scaner','race_Hull','GI,Bm.FormRace.2w_Race_'+ItemOwner(item));
                                3=if(ItemOwner(item)==5)InterfaceImage('Scaner','race_Hull','GI,Bm.FormRace.2w_Race_'+ItemOwner(item)+'_'+ItemSubrace(item));
                                4=for(i=1;i<9;i=i+1)
                                4 ^{
                                    0=slot=GetEquipmentStats(item,i);
                                    0=int open=0;
                                    1=if(i==3)InterfaceState('Scaner','InfoHull_Radar_off',(slot!=1));
                                    1=if(i==4)InterfaceState('Scaner','InfoHull_Scaner_off',(slot!=1));
                                    1=if(i==5)InterfaceState('Scaner','InfoHull_RepairRobot_off',(slot!=1));
                                    1=if(i==6)InterfaceState('Scaner','InfoHull_CargoHook_off',(slot!=1));
                                    1=if(i==7)InterfaceState('Scaner','InfoHull_DefGenerator_off',(slot!=1));
                                    1=if(i==8)InterfaceState('Scaner','InfoHull_Forsage_on',(slot!=0));
                                    2=if(i==1)
                                    2 ^{
                                        0=InterfaceState('Scaner','InfoHull_W1_off',1);
                                        0=InterfaceState('Scaner','InfoHull_W2_off',1);
                                        0=InterfaceState('Scaner','InfoHull_W3_off',1);
                                        0=InterfaceState('Scaner','InfoHull_W4_off',1);
                                        0=InterfaceState('Scaner','InfoHull_W5_off',1);
                                        0=open=1;
                                        1=while(open<=slot)
                                        1 ^{
                                            0=InterfaceState('Scaner','InfoHull_W'+open+'_off',0);
                                            1=open=open+1;
                                        }
                                    }
                                    3=if(i==2)
                                    3 ^{
                                        0=InterfaceState('Scaner','InfoHull_A1_off',1);
                                        0=InterfaceState('Scaner','InfoHull_A2_off',1);
                                        0=InterfaceState('Scaner','InfoHull_A3_off',1);
                                        0=InterfaceState('Scaner','InfoHull_A4_off',1);
                                        0=open = 1;
                                        1=while(open <= slot)
                                        1 ^{
                                            01=InterfaceState('Scaner', 'InfoHull_A' + open + '_off', 0);
                                            02=open = open + 1;
                                        }
                                    }
                                }
                            }
                            3=for(i=t_FuelTanks;i<t_Weapon1;i=i+1)
                            3 ^{
                                0=item=ShipEqInSlot(cur_ship,i);
                                1=if(item)
                                1 ^{
                                    0=if(ItemImprovement(item) || EqModule(item)>=0)cl='<color=0,255,0>';
                                    0=if(!ItemImprovement(item) && EqModule(item)<0)cl='<color=255,240,100>';
                                    0=if(ItemType(item)==t_FuelTanks)
                                    0 ^{
                                        0=text='Tank capacity: '+cl+GetEquipmentStats(item,0)+c_e+'. Fuel amount: '+c_y+ContainerFuel(item)+c_e+'.';
                                        1=if(ItemOwner(item)<=4 || ItemOwner(item)==6)InterfaceImage('Scaner','img_FuelTanks','GI,Bm.Items.2FuelTanks'+(ItemLevel(item)-1)+'s');
                                        2=if(ItemOwner(item)==5)InterfaceImage('Scaner','img_FuelTanks','GI,Bm.Items.2FuelTanksKling0s');
                                        3=if(EqSpecial(item)>=0 && ItemOwner(item)!=5)InterfaceImage('Scaner','img_FuelTanks','GI,Bm.Items.2FuelTanks'+CT('MicroModuls.'+BonusNumInCfg(EqSpecial(item))+'.KindGraph')+'s');
                                        4=InterfaceText('Scaner','text_FuelTanks',text);
                                        4=InterfaceText('Scaner','size_FuelTanks',ItemSize(item));
                                        4=InterfaceText('Scaner','cost_FuelTanks',ItemCost(item));
                                        5=InterfaceState('Scaner','w_FuelTanks',1);
                                        6=InterfaceText('Scaner','name_FuelTanks',ItemFullName(item));
                                        7=if(ItemOwner(item)!=5)InterfaceImage('Scaner','race_FuelTanks','GI,Bm.FormRace.2w_Race_'+ItemOwner(item));
                                        7=if(ItemOwner(item)==5)InterfaceImage('Scaner','race_FuelTanks','GI,Bm.FormRace.2w_Race_'+ItemOwner(item)+'_'+ItemSubrace(item));
                                    }
                                    0=if(ItemType(item)==t_Engine)
                                    0 ^{
                                        0=text='Allows for a top speed of '+cl+GetEquipmentStats(item,0)+c_e+' units and a hyperjump range of '+cl+GetEquipmentStats(item,1)+c_e+' parsecs.';
                                        1=if(ItemOwner(item)<=4 || ItemOwner(item)==6)InterfaceImage('Scaner','img_Engine','GI,Bm.Items.2Engine'+(ItemLevel(item)-1)+'s');
                                        2=if(ItemOwner(item)==5)InterfaceImage('Scaner','img_Engine','GI,Bm.Items.2EngineKling0s');
                                        3=if(EqSpecial(item)>=0 && ItemOwner(item)!=5)InterfaceImage('Scaner','img_Engine','GI,Bm.Items.2Engine'+CT('MicroModuls.'+BonusNumInCfg(EqSpecial(item))+'.KindGraph')+'s');
                                        4=InterfaceText('Scaner','text_Engine',text);
                                        4=InterfaceText('Scaner','size_Engine',ItemSize(item));
                                        4=InterfaceText('Scaner','cost_Engine',ItemCost(item));
                                        5=InterfaceState('Scaner','w_Engine',1);
                                        6=InterfaceText('Scaner','name_Engine',ItemFullName(item));
                                        7=if(ItemOwner(item)!=5)InterfaceImage('Scaner','race_Engine','GI,Bm.FormRace.2w_Race_'+ItemOwner(item));
                                        7=if(ItemOwner(item)==5)InterfaceImage('Scaner','race_Engine','GI,Bm.FormRace.2w_Race_'+ItemOwner(item)+'_'+ItemSubrace(item));
                                    }
                                    0=if(ItemType(item)==t_Radar)
                                    0 ^{
                                        0=text='Picks up data about objects within a radius of '+cl+GetEquipmentStats(item,0)+c_e+' mln. km.';
                                        1=if(ItemOwner(item)<=4 || ItemOwner(item)==6)InterfaceImage('Scaner','img_Radar','GI,Bm.Items.2Radar'+(ItemLevel(item)-1)+'s');
                                        2=if(ItemOwner(item)==5)InterfaceImage('Scaner','img_Radar','GI,Bm.Items.2RadarKling0s');
                                        3=if(EqSpecial(item)>=0 && ItemOwner(item)!=5)InterfaceImage('Scaner','img_Radar','GI,Bm.Items.2Radar'+CT('MicroModuls.'+BonusNumInCfg(EqSpecial(item))+'.KindGraph')+'s');
                                        4=InterfaceText('Scaner','text_Radar',text);
                                        4=InterfaceText('Scaner','size_Radar',ItemSize(item));
                                        4=InterfaceText('Scaner','cost_Radar',ItemCost(item));
                                        5=InterfaceState('Scaner','w_Radar',1);
                                        6=InterfaceText('Scaner','name_Radar',ItemFullName(item));
                                        7=if(ItemOwner(item)!=5)InterfaceImage('Scaner','race_Radar','GI,Bm.FormRace.2w_Race_'+ItemOwner(item));
                                        7=if(ItemOwner(item)==5)InterfaceImage('Scaner','race_Radar','GI,Bm.FormRace.2w_Race_'+ItemOwner(item)+'_'+ItemSubrace(item));
                                    }
                                    0=if(ItemType(item)==t_Scaner)
                                    0 ^{
                                        0=text='Scans for objects with a shield generator at less than '+cl+GetEquipmentStats(item,0)+c_e+'%';
                                        1=if(ItemOwner(item)<=4 || ItemOwner(item)==6)InterfaceImage('Scaner','img_Scaner','GI,Bm.Items.2Scaner'+(ItemLevel(item)-1)+'s');
                                        2=if(ItemOwner(item)==5)InterfaceImage('Scaner','img_Scaner','GI,Bm.Items.2ScanerKling0s');
                                        3=if(EqSpecial(item)>=0 && ItemOwner(item)!=5)InterfaceImage('Scaner','img_Scaner','GI,Bm.Items.2Scaner'+CT('MicroModuls.'+BonusNumInCfg(EqSpecial(item))+'.KindGraph')+'s');
                                        4=InterfaceText('Scaner','text_Scaner',text);
                                        4=InterfaceText('Scaner','size_Scaner',ItemSize(item));
                                        4=InterfaceText('Scaner','cost_Scaner',ItemCost(item));
                                        5=InterfaceState('Scaner','w_Scaner',1);
                                        6=InterfaceText('Scaner','name_Scaner',ItemFullName(item));
                                        7=if(ItemOwner(item)!=5)InterfaceImage('Scaner','race_Scaner','GI,Bm.FormRace.2w_Race_'+ItemOwner(item));
                                        7=if(ItemOwner(item)==5)InterfaceImage('Scaner','race_Scaner','GI,Bm.FormRace.2w_Race_'+ItemOwner(item)+'_'+ItemSubrace(item));
                                    }
                                    0=if(ItemType(item)==t_RepairRobot)
                                    0 ^{
                                        0=text='Restores '+cl+GetEquipmentStats(item,0)+c_e+' hit points to the ship skin.';
                                        1=if(ItemOwner(item)<=4 || ItemOwner(item)==6)InterfaceImage('Scaner','img_RepairRobot','GI,Bm.Items.2RepairRobot'+(ItemLevel(item)-1)+'s');
                                        2=if(ItemOwner(item)==5)InterfaceImage('Scaner','img_RepairRobot','GI,Bm.Items.2RepairRobotKling0s');
                                        3=if(EqSpecial(item)>=0 && ItemOwner(item)!=5)InterfaceImage('Scaner','img_RepairRobot','GI,Bm.Items.2RepairRobot'+CT('MicroModuls.'+BonusNumInCfg(EqSpecial(item))+'.KindGraph')+'s');
                                        4=InterfaceText('Scaner','text_RepairRobot',text);
                                        4=InterfaceText('Scaner','size_RepairRobot',ItemSize(item));
                                        4=InterfaceText('Scaner','cost_RepairRobot',ItemCost(item));
                                        5=InterfaceState('Scaner','w_RepairRobot',1);
                                        6=InterfaceText('Scaner','name_RepairRobot',ItemFullName(item));
                                        7=if(ItemOwner(item)!=5)InterfaceImage('Scaner','race_RepairRobot','GI,Bm.FormRace.2w_Race_'+ItemOwner(item));
                                        7=if(ItemOwner(item)==5)InterfaceImage('Scaner','race_RepairRobot','GI,Bm.FormRace.2w_Race_'+ItemOwner(item)+'_'+ItemSubrace(item));
                                    }
                                    0=if(ItemType(item)==t_CargoHook)
                                    0 ^{
                                        0=text='Grips small objects up to '+cl+GetEquipmentStats(item,0)+c_e+' units in size within a radius of '+cl+GetEquipmentStats(item,1)+c_e+'.';
                                        1=if(ItemOwner(item)<=4 || ItemOwner(item)==6)InterfaceImage('Scaner','img_CargoHook','GI,Bm.Items.2CargoHook'+(ItemLevel(item)-1)+'s');
                                        2=if(ItemOwner(item)==5)InterfaceImage('Scaner','img_CargoHook','GI,Bm.Items.2CargoHookKling0s');
                                        3=if(EqSpecial(item)>=0 && ItemOwner(item)!=5)InterfaceImage('Scaner','img_CargoHook','GI,Bm.Items.2CargoHook'+CT('MicroModuls.'+BonusNumInCfg(EqSpecial(item))+'.KindGraph')+'s');
                                        4=InterfaceText('Scaner','text_CargoHook',text);
                                        4=InterfaceText('Scaner','size_CargoHook',ItemSize(item));
                                        4=InterfaceText('Scaner','cost_CargoHook',ItemCost(item));
                                        5=InterfaceState('Scaner','w_CargoHook',1);
                                        6=InterfaceText('Scaner','name_CargoHook',ItemFullName(item));
                                        7=if(ItemOwner(item)!=5)InterfaceImage('Scaner','race_CargoHook','GI,Bm.FormRace.2w_Race_'+ItemOwner(item));
                                        7=if(ItemOwner(item)==5)InterfaceImage('Scaner','race_CargoHook','GI,Bm.FormRace.2w_Race_'+ItemOwner(item)+'_'+ItemSubrace(item));
                                    }
                                    0=if(ItemType(item)==t_DefGenerator)
                                    0 ^{
                                        0=text='Blocks '+cl+GetEquipmentStats(item,0)+c_e+'% of incoming damage.';
                                        1=if(ItemOwner(item)<=4 || ItemOwner(item)==6)InterfaceImage('Scaner','img_DefGenerator','GI,Bm.Items.2DefGenerator'+(ItemLevel(item)-1)+'s');
                                        2=if(ItemOwner(item)==5)InterfaceImage('Scaner','img_DefGenerator','GI,Bm.Items.2DefGeneratorKling0s');
                                        3=if(EqSpecial(item)>=0 && ItemOwner(item)!=5)InterfaceImage('Scaner','img_DefGenerator','GI,Bm.Items.2DefGenerator'+CT('MicroModuls.'+BonusNumInCfg(EqSpecial(item))+'.KindGraph')+'s');
                                        4=InterfaceText('Scaner','text_DefGenerator',text);
                                        4=InterfaceText('Scaner','size_DefGenerator',ItemSize(item));
                                        4=InterfaceText('Scaner','cost_DefGenerator',ItemCost(item));
                                        5=InterfaceState('Scaner','w_DefGenerator',1);
                                        6=InterfaceText('Scaner','name_DefGenerator',ItemFullName(item));
                                        7=if(ItemOwner(item)!=5)InterfaceImage('Scaner','race_DefGenerator','GI,Bm.FormRace.2w_Race_'+ItemOwner(item));
                                        7=if(ItemOwner(item)==5)InterfaceImage('Scaner','race_DefGenerator','GI,Bm.FormRace.2w_Race_'+ItemOwner(item)+'_'+ItemSubrace(item));
                                    }
                                }
                            }
                            4=for(i=1;i<6;i=i+1)
                            4 ^{
                                0=item=ShipEqInSlot(cur_ship,t_Weapon1,i);
                                1=if(item)
                                1 ^{
                                    0=item=ShipEqInSlot(cur_ship,t_Weapon1,i);
                                    0=if(ItemType(item)!=t_CustomWeapon)text=CT('Items.Weapon.Text.'+(ItemType(item)-t_DefGenerator));
                                    0=if(ItemType(item)==t_CustomWeapon)text=CT('Items.Weapon.Text.'+CustomWeaponType(item));
                                    0=if(count(text)<122)
                                    0 ^{
                                        0=move_x=-120;
                                        1=move_y=-150;
                                        2=InterfaceSize('Scaner','text_Weapon_'+i,0,0);
                                    }
                                    0=if(count(text)>=122 && count(text)<147)
                                    0 ^{
                                        0=move_x=-105;
                                        0=move_y=-145;
                                        2=InterfaceSize('Scaner','text_Weapon_'+i,225,0);
                                    }
                                    0=if(count(text)>=147 && count(text)<186)
                                    0 ^{
                                        0=move_x=-90;
                                        0=move_y=-140;
                                        2=InterfaceSize('Scaner','text_Weapon_'+i,245,0);
                                    }
                                    0=if(count(text)>=186 && count(text)<219)
                                    0 ^{
                                        0=move_x=-85;
                                        0=move_y=-132;
                                        2=InterfaceSize('Scaner','text_Weapon_'+i,255,0);
                                    }
                                    0=if(count(text)>=219 && count(text)<265)
                                    0 ^{
                                        0=move_x=-75;
                                        0=move_y=-121;
                                        2=InterfaceSize('Scaner','text_Weapon_'+i,255,0);
                                    }
                                    0=if(count(text)>=265 && count(text)<314)
                                    0 ^{
                                        0=move_x=-75;
                                        0=move_y=-95;
                                        2=InterfaceSize('Scaner','text_Weapon_'+i,255,0);
                                    }
                                    0=if(count(text)>=314)
                                    0 ^{
                                        0=move_x=-45;
                                        0=move_y=-95;
                                        2=InterfaceSize('Scaner','text_Weapon_'+i,285,0);
                                    }
                                    0=add_int=GetEquipmentStats(item,5);
                                    1=if(ItemImprovement(item) || EqModule(item)>=0)text=Format(text,'<CntAttacks>',GetEquipmentStats(item,4),'<MinDamage>',GetEquipmentStats(item,1),'<MaxDamage>','<color=0,255,0>'+GetEquipmentStats(item,0)+'</color>','<Radius>','<color=0,255,0>'+GetEquipmentStats(item,2)+'</color>','<Count>',WeaponAmmunition(item),'<MaxCount>',WeaponMaxAmmunition(item),'<CntShots>',add_int);
                                    1=if(!ItemImprovement(item) && EqModule(item)<0)text=Format(text,'<CntAttacks>',GetEquipmentStats(item,4),'<MinDamage>',GetEquipmentStats(item,1),'<MaxDamage>',GetEquipmentStats(item,0),'<Radius>',GetEquipmentStats(item,2),'<Count>',WeaponAmmunition(item),'<MaxCount>',WeaponMaxAmmunition(item),'<CntShots>',add_int);
                                    1=if(ItemType(item)<t_Weapon10)ts='0'+(ItemType(item)-t_DefGenerator);
                                    1=if(ItemType(item)>=t_Weapon10)ts=''+(ItemType(item)-t_DefGenerator);
                                    2=if(EqSpecial(item)<0 && ItemType(item)!=t_CustomWeapon)InterfaceImage('Scaner','img_Weapon_'+i,'GI,Bm.Items.2W'+ts+'s');
                                    2=if(EqSpecial(item)<0 && ItemType(item)==t_CustomWeapon)InterfaceImage('Scaner','img_Weapon_'+i,'GI,Bm.Items.2W'+CustomWeaponType(item)+'s');
                                    2=InterfaceText('Scaner','name_Weapon_'+i,ItemFullName(item));
                                    3=if(EqSpecial(item)>=0)
                                    3 ^{
                                        0=if(ItemType(item)!=t_CustomWeapon)InterfaceImage('Scaner','img_Weapon_'+i,'GI,Bm.Items.2W'+ts+CT('MicroModuls.'+BonusNumInCfg(EqSpecial(item))+'.KindGraph')+'s');
                                        1=else InterfaceImage('Scaner','img_Weapon_'+i,'GI,Bm.Items.2W'+CustomWeaponType(item)+'s');
                                        2=InterfaceText('Scaner','name_Weapon_'+i,ItemFullName(item)+' '+BonusName(EqSpecial(item)));
                                    }
                                    4=InterfaceText('Scaner','text_Weapon_'+i,text);
                                    4=InterfaceText('Scaner','size_Weapon_'+i,ItemSize(item));
                                    4=InterfaceText('Scaner','cost_Weapon_'+i,ItemCost(item));
                                    5=InterfaceState('Scaner','w_Weapon_'+i,1);
                                    7=if(ItemOwner(item)!=5)InterfaceImage('Scaner','race_Weapon_'+i,'GI,Bm.FormRace.2w_Race_'+ItemOwner(item));
                                    7=if(ItemOwner(item)==5)InterfaceImage('Scaner','race_Weapon_'+i,'GI,Bm.FormRace.2w_Race_'+ItemOwner(item)+'_'+ItemSubrace(item));
                                    8=InterfacePos('Scaner','tr_Weapon_'+i,move_x,0,0);
                                    8=InterfacePos('Scaner','br_Weapon_'+i,move_x,move_y,0);
                                    8=InterfacePos('Scaner','race_Weapon_'+i,move_x,move_y,0);
                                    8=InterfaceSize('Scaner','p_Weapon_'+i,336+move_x,0);
                                    8=InterfacePos('Scaner','bl_Weapon_'+i,0,move_y,0);
                                    8=InterfacePos('Scaner','c_Weapon_'+i,move_x,move_y,0);
                                    8=InterfacePos('Scaner','size_Weapon_'+i,0,move_y,0);
                                    8=InterfacePos('Scaner','cost_Weapon_'+i,0,move_y,0);
                                }
                            }
                        }
                        OnMouseLeaveCode ^{
                            0=InterfaceState('Scaner','w_Hull',0);
                            0=InterfaceState('Scaner','w_FuelTanks',0);
                            0=InterfaceState('Scaner','w_Engine',0);
                            0=InterfaceState('Scaner','w_Radar',0);
                            0=InterfaceState('Scaner','w_Scaner',0);
                            0=InterfaceState('Scaner','w_RepairRobot',0);
                            0=InterfaceState('Scaner','w_CargoHook',0);
                            0=InterfaceState('Scaner','w_DefGenerator',0);
                            0=InterfaceState('Scaner','w_Weapon_1',0);
                            0=InterfaceState('Scaner','w_Weapon_2',0);
                            0=InterfaceState('Scaner','w_Weapon_3',0);
                            0=InterfaceState('Scaner','w_Weapon_4',0);
                            0=InterfaceState('Scaner','w_Weapon_5',0);
                        }
                        Pos=15,51,0
                        Size=35,33
                    }
                    Name=AstAddScaner
                    Pos=967,541,-10
                    PosAutoCorrection=True
                    PosAutoCorrectionXCoef=1
                    PosAutoCorrectionYCoef=1
                    Size=57,100
                }
                Panel ^{
                    Active=False
                    Image ^{
                        Image=GI,Bm.Items.2Hull_People_R_s
                        Name=img_Weapon_1
                        Pos=16,14,0
                        Size=35,35
                    }
                    Image ^{
                        Image=GI,Bm.FormInfo3.2CW_tl
                        Name=tl_Weapon_1
                        Pos=0,0,6
                        Size=118,59
                    }
                    Image ^{
                        Image=GI,Bm.FormInfo3.2CW_p
                        Name=p_Weapon_1
                        Pos=16,59,6
                        Size=336,6
                    }
                    Label ^{
                        AlignX=Left
                        AlignY=CenterEx
                        Font=Font.2Normal
                        Name=size_Weapon_1
                        Pos=49,270,0
                        Size=45,33
                        TextColor=255,255,255
                        WordWrap=True
                    }
                    Label ^{
                        AlignX=Left
                        AlignY=CenterEx
                        Font=Font.2Normal
                        Name=cost_Weapon_1
                        Pos=117,270,0
                        Size=100,33
                        TextColor=255,255,255
                        WordWrap=True
                    }
                    Label ^{
                        AlignX=Center
                        AlignY=CenterEx
                        Font=Font.2SmallBold
                        Name=name_Weapon_1
                        Pos=60,13,0
                        Size=165,40
                        TextColor=57,239,255
                        WordWrap=True
                    }
                    Label ^{
                        AlignX=Center
                        AlignY=Top
                        Font=Font.2Small
                        Name=text_Weapon_1
                        Pos=24,64,0
                        Size=205,200
                        TextColor=255,255,255
                        WordWrap=True
                    }
                    Name=w_Weapon_1
                    Panel ^{
                        Image ^{
                            Image=GI,Bm.FormInfo3.2CW_tr
                            Name=tr_Weapon_1
                            Pos=0,0,6
                            Size=250,59
                        }
                        Image ^{
                            Image=GI,Bm.FormInfo3.2BRacePeopleN
                            Name=race_Weapon_1
                            Pos=200,268,0
                            Size=35,35
                        }
                        Name=mp_Weapon_1
                        Pos=118,0,6
                        Size=368,309
                    }
                    Panel ^{
                        Image ^{
                            Image=GI,Bm.FormInfo3.2CW_bl
                            Name=bl_Weapon_1
                            Pos=0,0,6
                            Size=118,250
                        }
                        Name=mp_2_Weapon_1
                        Pos=0,59,6
                        Size=118,250
                    }
                    Panel ^{
                        Image ^{
                            Image=GI,Bm.FormInfo3.2CW_c
                            Name=c_Weapon_1
                            Pos=0,0,6
                            Size=336,206
                        }
                        Name=mp_3_Weapon_1
                        Pos=16,65,6
                        Size=336,206
                    }
                    Panel ^{
                        Image ^{
                            Image=GI,Bm.FormInfo3.2CW_br
                            Name=br_Weapon_1
                            Pos=0,0,6
                            Size=250,250
                        }
                        Name=mp_4_Weapon_1
                        Pos=118,59,6
                        Size=250,250
                    }
                    Pos=30,195,3
                    PosAutoCorrection=True
                    PosAutoCorrectionXCoef=0.5
                    PosAutoCorrectionYCoef=0.5
                    Size=368,309
                }
                Panel ^{
                    Active=False
                    Image ^{
                        Image=GI,Bm.Items.2Hull_People_R_s
                        Name=img_Weapon_2
                        Pos=16,14,0
                        Size=35,35
                    }
                    Image ^{
                        Image=GI,Bm.FormInfo3.2CW_tl
                        Name=tl_Weapon_2
                        Pos=0,0,6
                        Size=118,59
                    }
                    Image ^{
                        Image=GI,Bm.FormInfo3.2CW_p
                        Name=p_Weapon_2
                        Pos=16,59,6
                        Size=336,6
                    }
                    Label ^{
                        AlignX=Left
                        AlignY=CenterEx
                        Font=Font.2Normal
                        Name=size_Weapon_2
                        Pos=49,270,0
                        Size=45,33
                        TextColor=255,255,255
                        WordWrap=True
                    }
                    Label ^{
                        AlignX=Left
                        AlignY=CenterEx
                        Font=Font.2Normal
                        Name=cost_Weapon_2
                        Pos=117,270,0
                        Size=100,33
                        TextColor=255,255,255
                        WordWrap=True
                    }
                    Label ^{
                        AlignX=Center
                        AlignY=CenterEx
                        Font=Font.2SmallBold
                        Name=name_Weapon_2
                        Pos=60,13,0
                        Size=165,40
                        TextColor=57,239,255
                        WordWrap=True
                    }
                    Label ^{
                        AlignX=Center
                        AlignY=Top
                        Font=Font.2Small
                        Name=text_Weapon_2
                        Pos=24,64,0
                        Size=205,200
                        TextColor=255,255,255
                        WordWrap=True
                    }
                    Name=w_Weapon_2
                    Panel ^{
                        Image ^{
                            Image=GI,Bm.FormInfo3.2CW_tr
                            Name=tr_Weapon_2
                            Pos=0,0,6
                            Size=250,59
                        }
                        Image ^{
                            Image=GI,Bm.FormInfo3.2BRacePeopleN
                            Name=race_Weapon_2
                            Pos=200,268,0
                            Size=35,35
                        }
                        Name=mp_Weapon_2
                        Pos=118,0,6
                        Size=368,309
                    }
                    Panel ^{
                        Image ^{
                            Image=GI,Bm.FormInfo3.2CW_bl
                            Name=bl_Weapon_2
                            Pos=0,0,6
                            Size=118,250
                        }
                        Name=mp_2_Weapon_2
                        Pos=0,59,6
                        Size=118,250
                    }
                    Panel ^{
                        Image ^{
                            Image=GI,Bm.FormInfo3.2CW_c
                            Name=c_Weapon_2
                            Pos=0,0,6
                            Size=336,206
                        }
                        Name=mp_3_Weapon_2
                        Pos=16,65,6
                        Size=336,206
                    }
                    Panel ^{
                        Image ^{
                            Image=GI,Bm.FormInfo3.2CW_br
                            Name=br_Weapon_2
                            Pos=0,0,6
                            Size=250,250
                        }
                        Name=mp_4_Weapon_2
                        Pos=118,59,6
                        Size=250,250
                    }
                    Pos=335,195,3
                    PosAutoCorrection=True
                    PosAutoCorrectionXCoef=0.5
                    PosAutoCorrectionYCoef=0.5
                    Size=368,309
                }
                Panel ^{
                    Active=False
                    Image ^{
                        Image=GI,Bm.Items.2Hull_People_R_s
                        Name=img_Weapon_3
                        Pos=16,14,0
                        Size=35,35
                    }
                    Image ^{
                        Image=GI,Bm.FormInfo3.2CW_tl
                        Name=tl_Weapon_3
                        Pos=0,0,6
                        Size=118,59
                    }
                    Image ^{
                        Image=GI,Bm.FormInfo3.2CW_p
                        Name=p_Weapon_3
                        Pos=16,59,6
                        Size=336,6
                    }
                    Label ^{
                        AlignX=Left
                        AlignY=CenterEx
                        Font=Font.2Normal
                        Name=size_Weapon_3
                        Pos=49,270,0
                        Size=45,33
                        TextColor=255,255,255
                        WordWrap=True
                    }
                    Label ^{
                        AlignX=Left
                        AlignY=CenterEx
                        Font=Font.2Normal
                        Name=cost_Weapon_3
                        Pos=117,270,0
                        Size=100,33
                        TextColor=255,255,255
                        WordWrap=True
                    }
                    Label ^{
                        AlignX=Center
                        AlignY=CenterEx
                        Font=Font.2SmallBold
                        Name=name_Weapon_3
                        Pos=60,13,0
                        Size=165,40
                        TextColor=57,239,255
                        WordWrap=True
                    }
                    Label ^{
                        AlignX=Center
                        AlignY=Top
                        Font=Font.2Small
                        Name=text_Weapon_3
                        Pos=24,64,0
                        Size=205,200
                        TextColor=255,255,255
                        WordWrap=True
                    }
                    Name=w_Weapon_3
                    Panel ^{
                        Image ^{
                            Image=GI,Bm.FormInfo3.2CW_tr
                            Name=tr_Weapon_3
                            Pos=0,0,6
                            Size=250,59
                        }
                        Image ^{
                            Image=GI,Bm.FormInfo3.2BRacePeopleN
                            Name=race_Weapon_3
                            Pos=200,268,0
                            Size=35,35
                        }
                        Name=mp_Weapon_3
                        Pos=118,0,6
                        Size=368,309
                    }
                    Panel ^{
                        Image ^{
                            Image=GI,Bm.FormInfo3.2CW_bl
                            Name=bl_Weapon_3
                            Pos=0,0,6
                            Size=118,250
                        }
                        Name=mp_2_Weapon_3
                        Pos=0,59,6
                        Size=118,250
                    }
                    Panel ^{
                        Image ^{
                            Image=GI,Bm.FormInfo3.2CW_c
                            Name=c_Weapon_3
                            Pos=0,0,6
                            Size=336,206
                        }
                        Name=mp_3_Weapon_3
                        Pos=16,65,6
                        Size=336,206
                    }
                    Panel ^{
                        Image ^{
                            Image=GI,Bm.FormInfo3.2CW_br
                            Name=br_Weapon_3
                            Pos=0,0,6
                            Size=250,250
                        }
                        Name=mp_4_Weapon_3
                        Pos=118,59,6
                        Size=250,250
                    }
                    Pos=640,195,3
                    PosAutoCorrection=True
                    PosAutoCorrectionXCoef=0.5
                    PosAutoCorrectionYCoef=0.5
                    Size=368,309
                }
                Panel ^{
                    Active=False
                    Image ^{
                        Image=GI,Bm.Items.2Hull_People_R_s
                        Name=img_Weapon_4
                        Pos=16,14,0
                        Size=35,35
                    }
                    Image ^{
                        Image=GI,Bm.FormInfo3.2CW_tl
                        Name=tl_Weapon_4
                        Pos=0,0,6
                        Size=118,59
                    }
                    Image ^{
                        Image=GI,Bm.FormInfo3.2CW_p
                        Name=p_Weapon_4
                        Pos=16,59,6
                        Size=336,6
                    }
                    Label ^{
                        AlignX=Left
                        AlignY=CenterEx
                        Font=Font.2Normal
                        Name=size_Weapon_4
                        Pos=49,270,0
                        Size=45,33
                        TextColor=255,255,255
                        WordWrap=True
                    }
                    Label ^{
                        AlignX=Left
                        AlignY=CenterEx
                        Font=Font.2Normal
                        Name=cost_Weapon_4
                        Pos=117,270,0
                        Size=100,33
                        TextColor=255,255,255
                        WordWrap=True
                    }
                    Label ^{
                        AlignX=Center
                        AlignY=CenterEx
                        Font=Font.2SmallBold
                        Name=name_Weapon_4
                        Pos=60,13,0
                        Size=165,40
                        TextColor=57,239,255
                        WordWrap=True
                    }
                    Label ^{
                        AlignX=Center
                        AlignY=Top
                        Font=Font.2Small
                        Name=text_Weapon_4
                        Pos=24,64,0
                        Size=205,200
                        TextColor=255,255,255
                        WordWrap=True
                    }
                    Name=w_Weapon_4
                    Panel ^{
                        Image ^{
                            Image=GI,Bm.FormInfo3.2CW_tr
                            Name=tr_Weapon_4
                            Pos=0,0,6
                            Size=250,59
                        }
                        Image ^{
                            Image=GI,Bm.FormInfo3.2BRacePeopleN
                            Name=race_Weapon_4
                            Pos=200,268,0
                            Size=35,35
                        }
                        Name=mp_Weapon_4
                        Pos=118,0,6
                        Size=368,309
                    }
                    Panel ^{
                        Image ^{
                            Image=GI,Bm.FormInfo3.2CW_bl
                            Name=bl_Weapon_4
                            Pos=0,0,6
                            Size=118,250
                        }
                        Name=mp_2_Weapon_4
                        Pos=0,59,6
                        Size=118,250
                    }
                    Panel ^{
                        Image ^{
                            Image=GI,Bm.FormInfo3.2CW_c
                            Name=c_Weapon_4
                            Pos=0,0,6
                            Size=336,206
                        }
                        Name=mp_3_Weapon_4
                        Pos=16,65,6
                        Size=336,206
                    }
                    Panel ^{
                        Image ^{
                            Image=GI,Bm.FormInfo3.2CW_br
                            Name=br_Weapon_4
                            Pos=0,0,6
                            Size=250,250
                        }
                        Name=mp_4_Weapon_4
                        Pos=118,59,6
                        Size=250,250
                    }
                    Pos=30,0,2
                    PosAutoCorrection=True
                    PosAutoCorrectionXCoef=0.5
                    PosAutoCorrectionYCoef=0.5
                    Size=368,309
                }
                Panel ^{
                    Active=False
                    Image ^{
                        Image=GI,Bm.Items.2Hull_People_R_s
                        Name=img_Weapon_5
                        Pos=16,14,0
                        Size=35,35
                    }
                    Image ^{
                        Image=GI,Bm.FormInfo3.2CW_tl
                        Name=tl_Weapon_5
                        Pos=0,0,6
                        Size=118,59
                    }
                    Image ^{
                        Image=GI,Bm.FormInfo3.2CW_p
                        Name=p_Weapon_5
                        Pos=16,59,6
                        Size=336,6
                    }
                    Label ^{
                        AlignX=Left
                        AlignY=CenterEx
                        Font=Font.2Normal
                        Name=size_Weapon_5
                        Pos=49,270,0
                        Size=45,33
                        TextColor=255,255,255
                        WordWrap=True
                    }
                    Label ^{
                        AlignX=Left
                        AlignY=CenterEx
                        Font=Font.2Normal
                        Name=cost_Weapon_5
                        Pos=117,270,0
                        Size=100,33
                        TextColor=255,255,255
                        WordWrap=True
                    }
                    Label ^{
                        AlignX=Center
                        AlignY=CenterEx
                        Font=Font.2SmallBold
                        Name=name_Weapon_5
                        Pos=60,13,0
                        Size=165,40
                        TextColor=57,239,255
                        WordWrap=True
                    }
                    Label ^{
                        AlignX=Center
                        AlignY=Top
                        Font=Font.2Small
                        Name=text_Weapon_5
                        Pos=24,64,0
                        Size=205,200
                        TextColor=255,255,255
                        WordWrap=True
                    }
                    Name=w_Weapon_5
                    Panel ^{
                        Image ^{
                            Image=GI,Bm.FormInfo3.2CW_tr
                            Name=tr_Weapon_5
                            Pos=0,0,6
                            Size=250,59
                        }
                        Image ^{
                            Image=GI,Bm.FormInfo3.2BRacePeopleN
                            Name=race_Weapon_5
                            Pos=200,268,0
                            Size=35,35
                        }
                        Name=mp_Weapon_5
                        Pos=118,0,6
                        Size=368,309
                    }
                    Panel ^{
                        Image ^{
                            Image=GI,Bm.FormInfo3.2CW_bl
                            Name=bl_Weapon_5
                            Pos=0,0,6
                            Size=118,250
                        }
                        Name=mp_2_Weapon_5
                        Pos=0,59,6
                        Size=118,250
                    }
                    Panel ^{
                        Image ^{
                            Image=GI,Bm.FormInfo3.2CW_c
                            Name=c_Weapon_5
                            Pos=0,0,6
                            Size=336,206
                        }
                        Name=mp_3_Weapon_5
                        Pos=16,65,6
                        Size=336,206
                    }
                    Panel ^{
                        Image ^{
                            Image=GI,Bm.FormInfo3.2CW_br
                            Name=br_Weapon_5
                            Pos=0,0,6
                            Size=250,250
                        }
                        Name=mp_4_Weapon_5
                        Pos=118,59,6
                        Size=250,250
                    }
                    Pos=335,0,2
                    PosAutoCorrection=True
                    PosAutoCorrectionXCoef=0.5
                    PosAutoCorrectionYCoef=0.5
                    Size=368,309
                }
                Window ^{
                    Active=False
                    Image ^{
                        Image=GI,Bm.FormRace.2w_Race_6
                        Name=img_Hull
                        Pos=17,17,0
                        Size=35,35
                    }
                    Image ^{
                        Image=GI,Bm.FormInfo3.2BRacePeopleN
                        Name=race_Hull
                        Pos=285,130,8
                        Size=35,35
                    }
                    Image ^{
                        Image=GI,Bm.FormNote.2HullBottomLeft
                        Pos=0,103,10
                        Size=265,72
                    }
                    Image ^{
                        Image=GI,Bm.FormNote.2HullBottomRight
                        Pos=263,103,10
                        Size=67,72
                    }
                    Image ^{
                        Image=GI,Bm.FormNote.2ItemBottomRight
                        Pos=115,75,10
                        Size=20,69
                    }
                    Label ^{
                        AlignX=Center
                        AlignY=CenterEx
                        Font=Font.2SmallBold
                        Name=name_Hull
                        Pos=80,13,8
                        Size=200,40
                        TextColor=57,239,255
                        WordWrap=True
                    }
                    Label ^{
                        AlignX=Center
                        AlignY=CenterEx
                        Font=Font.2Small
                        Name=text_Hull
                        Pos=100,55,8
                        Size=240,83
                        TextColor=255,255,255
                        WordWrap=True
                    }
                    Label ^{
                        AlignX=Left
                        AlignY=CenterEx
                        Font=Font.2Normal
                        Name=size_Hull
                        Pos=168,139,8
                        Size=45,33
                        TextColor=255,255,255
                        WordWrap=True
                    }
                    Label ^{
                        AlignX=Left
                        AlignY=CenterEx
                        Font=Font.2Normal
                        Name=cost_Hull
                        Pos=236,139,8
                        Size=100,33
                        TextColor=255,255,255
                        WordWrap=True
                    }
                    Name=w_Hull
                    Panel ^{
                        Image ^{
                            Image=GI,Bm.FormNote.2HP_Bg
                            Pos=0,0,9
                            Size=80,90
                        }
                        Image ^{
                            Image=GI,Bm.FormNote.2HP_Forsage
                            Name=InfoHull_Forsage_on
                            Pos=0,32
                            Size=14,15
                        }
                        Image ^{
                            Active=False
                            Image=GI,Bm.FormNote.2HP_W1
                            Name=InfoHull_W1_off
                            Pos=16,19
                            Size=16,13
                        }
                        Image ^{
                            Active=False
                            Image=GI,Bm.FormNote.2HP_W2
                            Name=InfoHull_W2_off
                            Pos=33,19
                            Size=15,13
                        }
                        Image ^{
                            Active=False
                            Image=GI,Bm.FormNote.2HP_W3
                            Name=InfoHull_W3_off
                            Pos=48,19
                            Size=18,13
                        }
                        Image ^{
                            Active=False
                            Image=GI,Bm.FormNote.2HP_W4
                            Name=InfoHull_W4_off
                            Pos=24,6
                            Size=16,13
                        }
                        Image ^{
                            Active=False
                            Image=GI,Bm.FormNote.2HP_W5
                            Name=InfoHull_W5_off
                            Pos=41,6
                            Size=15,13
                        }
                        Image ^{
                            Active=False
                            Image=GI,Bm.FormNote.2HP_A1
                            Name=InfoHull_A1_off
                            Pos=4,70
                            Size=13,8
                        }
                        Image ^{
                            Active=False
                            Image=GI,Bm.FormNote.2HP_A2
                            Name=InfoHull_A2_off
                            Pos=65,70
                            Size=11,8
                        }
                        Image ^{
                            Active=False
                            Image=GI,Bm.FormNote.2HP_A3
                            Name=InfoHull_A3_off
                            Pos=4,25
                            Size=13,7
                        }
                        Image ^{
                            Active=False
                            Image=GI,Bm.FormNote.2HP_A4
                            Name=InfoHull_A4_off
                            Pos=64,25
                            Size=12,7
                        }
                        Image ^{
                            Active=False
                            Image=GI,Bm.FormNote.2HP_Engine
                            Name=InfoHull_Engine_off
                            Pos=9,36
                            Size=17,14
                        }
                        Image ^{
                            Active=False
                            Image=GI,Bm.FormNote.2HP_FuelTanks
                            Name=InfoHull_FuelTanks_off
                            Pos=9,52
                            Size=17,14
                        }
                        Image ^{
                            Active=False
                            Image=GI,Bm.FormNote.2HP_Scaner
                            Name=InfoHull_Scaner_off
                            Pos=55,36
                            Size=17,14
                        }
                        Image ^{
                            Active=False
                            Image=GI,Bm.FormNote.2HP_Radar
                            Name=InfoHull_Radar_off
                            Pos=55,52
                            Size=17,14
                        }
                        Image ^{
                            Active=False
                            Image=GI,Bm.FormNote.2HP_RepairRobot
                            Name=InfoHull_RepairRobot_off
                            Pos=15,70
                            Size=17,13
                        }
                        Image ^{
                            Active=False
                            Image=GI,Bm.FormNote.2HP_CargoHook
                            Name=InfoHull_CargoHook_off
                            Pos=33,70
                            Size=15,13
                        }
                        Image ^{
                            Active=False
                            Image=GI,Bm.FormNote.2HP_DefGenerator
                            Name=InfoHull_DefGenerator_off
                            Pos=48,70
                            Size=18,13
                        }
                        Name=custom_InfoHull
                        Pos=22,68,7
                        Size=80,90
                    }
                    Pos=660,20,4
                    PosAutoCorrection=True
                    PosAutoCorrectionXCoef=0.5
                    PosAutoCorrectionYCoef=0.5
                    Size=330,175
                    Style=Style.Window.2Simple
                }
                Window ^{
                    Active=False
                    Image ^{
                        Image=GI,Bm.Items.2Hull_People_R_s
                        Name=img_Engine
                        Pos=16,14,0
                        Size=35,35
                    }
                    Image ^{
                        Image=GI,Bm.FormInfo3.2BRacePeopleN
                        Name=race_Engine
                        Pos=198,121,8
                        Size=35,35
                    }
                    Image ^{
                        Image=GI,Bm.FormNote.2ItemBottomLeft
                        Pos=0,90,10
                        Size=118,69
                    }
                    Image ^{
                        Image=GI,Bm.FormNote.2ItemBottomRight
                        Pos=130,90,10
                        Size=122,69
                    }
                    Image ^{
                        Image=GI,Bm.FormNote.2ItemBottomRight
                        Pos=115,90,10
                        Size=20,69
                    }
                    Label ^{
                        AlignX=Center
                        AlignY=CenterEx
                        Font=Font.2SmallBold
                        Name=name_Engine
                        Pos=60,13,8
                        Size=165,40
                        TextColor=57,239,255
                        WordWrap=True
                    }
                    Label ^{
                        AlignX=Center
                        AlignY=CenterEx
                        Font=Font.2Small
                        Name=text_Engine
                        Pos=10,45,8
                        Size=220,83
                        TextColor=255,255,255
                        WordWrap=True
                    }
                    Label ^{
                        AlignX=Left
                        AlignY=CenterEx
                        Font=Font.2Normal
                        Name=size_Engine
                        Pos=49,121,8
                        Size=45,33
                        TextColor=255,255,255
                        WordWrap=True
                    }
                    Label ^{
                        AlignX=Left
                        AlignY=CenterEx
                        Font=Font.2Normal
                        Name=cost_Engine
                        Pos=117,121,8
                        Size=100,33
                        TextColor=255,255,255
                        WordWrap=True
                    }
                    Name=w_Engine
                    Pos=5,390,4
                    PosAutoCorrection=True
                    PosAutoCorrectionXCoef=0.5
                    PosAutoCorrectionYCoef=0.5
                    Size=243,158
                    Style=Style.Window.2Simple
                }
                Window ^{
                    Active=False
                    Image ^{
                        Image=GI,Bm.Items.2Hull_People_R_s
                        Name=img_FuelTanks
                        Pos=16,14,0
                        Size=35,35
                    }
                    Image ^{
                        Image=GI,Bm.FormInfo3.2BRacePeopleN
                        Name=race_FuelTanks
                        Pos=198,121,8
                        Size=35,35
                    }
                    Image ^{
                        Image=GI,Bm.FormNote.2ItemBottomLeft
                        Pos=0,90,10
                        Size=118,69
                    }
                    Image ^{
                        Image=GI,Bm.FormNote.2ItemBottomRight
                        Pos=130,90,10
                        Size=122,69
                    }
                    Image ^{
                        Image=GI,Bm.FormNote.2ItemBottomRight
                        Pos=115,90,10
                        Size=20,69
                    }
                    Label ^{
                        AlignX=Center
                        AlignY=CenterEx
                        Font=Font.2SmallBold
                        Name=name_FuelTanks
                        Pos=60,13,8
                        Size=165,40
                        TextColor=57,239,255
                        WordWrap=True
                    }
                    Label ^{
                        AlignX=Center
                        AlignY=CenterEx
                        Font=Font.2Small
                        Name=text_FuelTanks
                        Pos=10,45,8
                        Size=220,83
                        TextColor=255,255,255
                        WordWrap=True
                    }
                    Label ^{
                        AlignX=Left
                        AlignY=CenterEx
                        Font=Font.2Normal
                        Name=size_FuelTanks
                        Pos=49,121,8
                        Size=45,33
                        TextColor=255,255,255
                        WordWrap=True
                    }
                    Label ^{
                        AlignX=Left
                        AlignY=CenterEx
                        Font=Font.2Normal
                        Name=cost_FuelTanks
                        Pos=117,121,8
                        Size=100,33
                        TextColor=255,255,255
                        WordWrap=True
                    }
                    Name=w_FuelTanks
                    Pos=250,390,4
                    PosAutoCorrection=True
                    PosAutoCorrectionXCoef=0.5
                    PosAutoCorrectionYCoef=0.5
                    Size=243,158
                    Style=Style.Window.2Simple
                }
                Window ^{
                    Active=False
                    Image ^{
                        Image=GI,Bm.Items.2Hull_People_R_s
                        Name=img_Scaner
                        Pos=16,14,0
                        Size=35,35
                    }
                    Image ^{
                        Image=GI,Bm.FormInfo3.2BRacePeopleN
                        Name=race_Scaner
                        Pos=198,121,8
                        Size=35,35
                    }
                    Image ^{
                        Image=GI,Bm.FormNote.2ItemBottomLeft
                        Pos=0,90,10
                        Size=118,69
                    }
                    Image ^{
                        Image=GI,Bm.FormNote.2ItemBottomRight
                        Pos=130,90,10
                        Size=122,69
                    }
                    Image ^{
                        Image=GI,Bm.FormNote.2ItemBottomRight
                        Pos=115,90,10
                        Size=20,69
                    }
                    Label ^{
                        AlignX=Center
                        AlignY=CenterEx
                        Font=Font.2SmallBold
                        Name=name_Scaner
                        Pos=60,13,8
                        Size=165,40
                        TextColor=57,239,255
                        WordWrap=True
                    }
                    Label ^{
                        AlignX=Center
                        AlignY=CenterEx
                        Font=Font.2Small
                        Name=text_Scaner
                        Pos=15,45,8
                        Size=210,83
                        TextColor=255,255,255
                        WordWrap=True
                    }
                    Label ^{
                        AlignX=Left
                        AlignY=CenterEx
                        Font=Font.2Normal
                        Name=size_Scaner
                        Pos=49,121,8
                        Size=45,33
                        TextColor=255,255,255
                        WordWrap=True
                    }
                    Label ^{
                        AlignX=Left
                        AlignY=CenterEx
                        Font=Font.2Normal
                        Name=cost_Scaner
                        Pos=117,121,8
                        Size=100,33
                        TextColor=255,255,255
                        WordWrap=True
                    }
                    Name=w_Scaner
                    Pos=495,390,4
                    PosAutoCorrection=True
                    PosAutoCorrectionXCoef=0.5
                    PosAutoCorrectionYCoef=0.5
                    Size=243,158
                    Style=Style.Window.2Simple
                }
                Window ^{
                    Active=False
                    Image ^{
                        Image=GI,Bm.Items.2Hull_People_R_s
                        Name=img_Radar
                        Pos=16,14,0
                        Size=35,35
                    }
                    Image ^{
                        Image=GI,Bm.FormInfo3.2BRacePeopleN
                        Name=race_Radar
                        Pos=198,121,8
                        Size=35,35
                    }
                    Image ^{
                        Image=GI,Bm.FormNote.2ItemBottomLeft
                        Pos=0,90,10
                        Size=118,69
                    }
                    Image ^{
                        Image=GI,Bm.FormNote.2ItemBottomRight
                        Pos=130,90,10
                        Size=122,69
                    }
                    Image ^{
                        Image=GI,Bm.FormNote.2ItemBottomRight
                        Pos=115,90,10
                        Size=20,69
                    }
                    Label ^{
                        AlignX=Center
                        AlignY=CenterEx
                        Font=Font.2SmallBold
                        Name=name_Radar
                        Pos=60,13,8
                        Size=165,40
                        TextColor=57,239,255
                        WordWrap=True
                    }
                    Label ^{
                        AlignX=Center
                        AlignY=CenterEx
                        Font=Font.2Small
                        Name=text_Radar
                        Pos=15,45,8
                        Size=210,83
                        TextColor=255,255,255
                        WordWrap=True
                    }
                    Label ^{
                        AlignX=Left
                        AlignY=CenterEx
                        Font=Font.2Normal
                        Name=size_Radar
                        Pos=49,121,8
                        Size=45,33
                        TextColor=255,255,255
                        WordWrap=True
                    }
                    Label ^{
                        AlignX=Left
                        AlignY=CenterEx
                        Font=Font.2Normal
                        Name=cost_Radar
                        Pos=117,121,8
                        Size=100,33
                        TextColor=255,255,255
                        WordWrap=True
                    }
                    Name=w_Radar
                    Pos=740,390,4
                    PosAutoCorrection=True
                    PosAutoCorrectionXCoef=0.5
                    PosAutoCorrectionYCoef=0.5
                    Size=243,158
                    Style=Style.Window.2Simple
                }
                Window ^{
                    Active=False
                    Image ^{
                        Image=GI,Bm.Items.2Hull_People_R_s
                        Name=img_CargoHook
                        Pos=16,14,0
                        Size=35,35
                    }
                    Image ^{
                        Image=GI,Bm.FormInfo3.2BRacePeopleN
                        Name=race_CargoHook
                        Pos=198,121,8
                        Size=35,35
                    }
                    Image ^{
                        Image=GI,Bm.FormNote.2ItemBottomLeft
                        Pos=0,90,10
                        Size=118,69
                    }
                    Image ^{
                        Image=GI,Bm.FormNote.2ItemBottomRight
                        Pos=130,90,10
                        Size=122,69
                    }
                    Image ^{
                        Image=GI,Bm.FormNote.2ItemBottomRight
                        Pos=115,90,10
                        Size=20,69
                    }
                    Label ^{
                        AlignX=Center
                        AlignY=CenterEx
                        Font=Font.2SmallBold
                        Name=name_CargoHook
                        Pos=60,13,8
                        Size=165,40
                        TextColor=57,239,255
                        WordWrap=True
                    }
                    Label ^{
                        AlignX=Center
                        AlignY=CenterEx
                        Font=Font.2Small
                        Name=text_CargoHook
                        Pos=10,45,8
                        Size=220,83
                        TextColor=255,255,255
                        WordWrap=True
                    }
                    Label ^{
                        AlignX=Left
                        AlignY=CenterEx
                        Font=Font.2Normal
                        Name=size_CargoHook
                        Pos=49,121,8
                        Size=45,33
                        TextColor=255,255,255
                        WordWrap=True
                    }
                    Label ^{
                        AlignX=Left
                        AlignY=CenterEx
                        Font=Font.2Normal
                        Name=cost_CargoHook
                        Pos=117,121,8
                        Size=100,33
                        TextColor=255,255,255
                        WordWrap=True
                    }
                    Name=w_CargoHook
                    Pos=127,535,4
                    PosAutoCorrection=True
                    PosAutoCorrectionXCoef=0.5
                    PosAutoCorrectionYCoef=0.5
                    Size=243,158
                    Style=Style.Window.2Simple
                }
                Window ^{
                    Active=False
                    Image ^{
                        Image=GI,Bm.Items.2Hull_People_R_s
                        Name=img_DefGenerator
                        Pos=16,14,0
                        Size=35,35
                    }
                    Image ^{
                        Image=GI,Bm.FormInfo3.2BRacePeopleN
                        Name=race_DefGenerator
                        Pos=198,121,8
                        Size=35,35
                    }
                    Image ^{
                        Image=GI,Bm.FormNote.2ItemBottomLeft
                        Pos=0,90,10
                        Size=118,69
                    }
                    Image ^{
                        Image=GI,Bm.FormNote.2ItemBottomRight
                        Pos=130,90,10
                        Size=122,69
                    }
                    Image ^{
                        Image=GI,Bm.FormNote.2ItemBottomRight
                        Pos=115,90,10
                        Size=20,69
                    }
                    Label ^{
                        AlignX=Center
                        AlignY=CenterEx
                        Font=Font.2SmallBold
                        Name=name_DefGenerator
                        Pos=60,13,8
                        Size=165,40
                        TextColor=57,239,255
                        WordWrap=True
                    }
                    Label ^{
                        AlignX=Center
                        AlignY=CenterEx
                        Font=Font.2Small
                        Name=text_DefGenerator
                        Pos=15,45,8
                        Size=210,83
                        TextColor=255,255,255
                        WordWrap=True
                    }
                    Label ^{
                        AlignX=Left
                        AlignY=CenterEx
                        Font=Font.2Normal
                        Name=size_DefGenerator
                        Pos=49,121,8
                        Size=45,33
                        TextColor=255,255,255
                        WordWrap=True
                    }
                    Label ^{
                        AlignX=Left
                        AlignY=CenterEx
                        Font=Font.2Normal
                        Name=cost_DefGenerator
                        Pos=117,121,8
                        Size=100,33
                        TextColor=255,255,255
                        WordWrap=True
                    }
                    Name=w_DefGenerator
                    Pos=617,535,4
                    PosAutoCorrection=True
                    PosAutoCorrectionXCoef=0.5
                    PosAutoCorrectionYCoef=0.5
                    Size=243,158
                    Style=Style.Window.2Simple
                }
                Window ^{
                    Active=False
                    Image ^{
                        Image=GI,Bm.Items.2Hull_People_R_s
                        Name=img_RepairRobot
                        Pos=16,14,0
                        Size=35,35
                    }
                    Image ^{
                        Image=GI,Bm.FormInfo3.2BRacePeopleN
                        Name=race_RepairRobot
                        Pos=198,121,8
                        Size=35,35
                    }
                    Image ^{
                        Image=GI,Bm.FormNote.2ItemBottomLeft
                        Pos=0,90,10
                        Size=118,69
                    }
                    Image ^{
                        Image=GI,Bm.FormNote.2ItemBottomRight
                        Pos=130,90,10
                        Size=122,69
                    }
                    Image ^{
                        Image=GI,Bm.FormNote.2ItemBottomRight
                        Pos=115,90,10
                        Size=20,69
                    }
                    Label ^{
                        AlignX=Center
                        AlignY=CenterEx
                        Font=Font.2SmallBold
                        Name=name_RepairRobot
                        Pos=60,13,8
                        Size=165,40
                        TextColor=57,239,255
                        WordWrap=True
                    }
                    Label ^{
                        AlignX=Center
                        AlignY=CenterEx
                        Font=Font.2Small
                        Name=text_RepairRobot
                        Pos=0,45,8
                        Size=240,83
                        TextColor=255,255,255
                        WordWrap=True
                    }
                    Label ^{
                        AlignX=Left
                        AlignY=CenterEx
                        Font=Font.2Normal
                        Name=size_RepairRobot
                        Pos=49,121,8
                        Size=45,33
                        TextColor=255,255,255
                        WordWrap=True
                    }
                    Label ^{
                        AlignX=Left
                        AlignY=CenterEx
                        Font=Font.2Normal
                        Name=cost_RepairRobot
                        Pos=117,121,8
                        Size=100,33
                        TextColor=255,255,255
                        WordWrap=True
                    }
                    Name=w_RepairRobot
                    Pos=372,535,4
                    PosAutoCorrection=True
                    PosAutoCorrectionXCoef=0.5
                    PosAutoCorrectionYCoef=0.5
                    Size=243,158
                    Style=Style.Window.2Simple
                }
            }
        }
    }
    Ship ^{
        Panel ^{
            Panel ^{
                Assistant ^{
                    Panel ^{
                        Active=True
                        Image ^{
                            Image=GI,Bm.FormAst.2AstAddition
                            Pos=0,0,2
                            Size=57,100
                        }
                        Image ^{
                            Image=GI,Bm.FormAst.2AstAddStatsN
                            Name=AstShipStat
                            OnMouseEnterCode ^{
                                0=if(FormCurShip()!=Player())exit;
                                0=InterfaceState('Ship','Stat_window',1);
                                0=dword ship=Player();
                                1=str br=substr(CT('FormScore.DateWin'),5,2);
                                1=str text='';
                                2=text='del_s'+GetShipExpByType(ship,0)+' '+br+GetShipExpByType(ship,1)+' '+br+GetShipExpByType(ship,2)+' '+br+GetShipExpByType(ship,3)+' '+br+GetShipExpByType(ship,4)+' '+br+(GetShipExpByType(ship,0)-GetShipExpByType(ship,1)-GetShipExpByType(ship,2)-GetShipExpByType(ship,3)-GetShipExpByType(ship,4))+' ';
                                2=text=Format(text,'del_s','');
                                2=InterfaceText('Ship','exp_str',text);
                                3=text='del_s'+ShipStatistic(ship,0)+' '+br+ShipStatistic(ship,1)+' '+br+ShipStatistic(ship,2)+' '+br+ShipStatistic(ship,4)+' '+br+ShipStatistic(ship,5)+' '+br+ShipStatistic(ship,6)+' ';
                                3=text=Format(text,'del_s','');
                                3=InterfaceText('Ship','kill_ship_str',text);
                                4=text='del_s'+PlayerQuestsCompleted()+' '+br+PlayerQuestsCompleted(0)+' '+br+PlayerQuestsCompleted(1)+' '+br+PlayerQuestsCompleted(2)+' '+br+PlayerQuestsCompleted(3)+' '+br+PlayerQuestsCompleted(4)+' '+br+PlayerPlanetaryBattlesCompleted()+' ';
                                4=text=Format(text,'del_s','');
                                4=InterfaceText('Ship','quest_str',text);
                                5=text='del_s'+ShipKillFactionInCurSystem(ship,0)+' '+br+ShipKillFactionInCurSystem(ship,1)+' '+br+ShipKillFactionInCurSystem(ship,2)+' ';
                                5=text=Format(text,'del_s','');
                                5=InterfaceText('Ship','kill_ship_star_str',text);
                                6=InterfaceText('Ship','Ship_name_stat',Name(Player()));
                                7=InterfaceText('Ship','GTU_stat',GalaxyTechLevel());
                            }
                            OnMouseLeaveCode ^{
                                0=InterfaceState('Ship','Stat_window',0);
                            }
                            Pos=15,15,0
                            Size=35,33
                        }
                        Image ^{
                            Image=GI,Bm.FormAst.2AstAddShotN
                            Name=AstShipShot
                            OnMouseEnterCode ^{
                                0=dword cur_ship=FormCurShip();
                                0=int move_x=0;
                                0=int move_y=0;
                                0=int add_int=0;
                                1=str text='';
                                1=str cl;
                                1=str c_y='<color=255,240,100>';
                                1=str c_e='</color>';
                                1=str ts='';
                                1=dword item=0;
                                1=int i=0;
                                1=str br=substr(CT('FormScore.DateWin'),5,2);
                                2=if(ShipEqInSlot(cur_ship,t_Hull)>0)
                                2 ^{
                                    0=item=ShipEqInSlot(cur_ship,t_Hull);
                                    0=if(ItemImprovement(item) || EqModule(item)>=0)cl='<color=0,255,0>';
                                    0=if(!ItemImprovement(item) && EqModule(item)<0)cl='<color=255,240,100>';
                                    0=InterfaceText('Ship','name_Hull',ItemFullName(item));
                                    0=if(HullSeries(item)>=0 && HullSeries(item)<255)InterfaceText('Ship','name_Hull',ItemFullName(item)+br+'<color=82,166,255>'+'Series \"'+CT('HullType.'+SeriesNumInCfg(HullSeries(item))+'.Name')+'\"');
                                    0=int slot=0;
                                    1=text='Hull durability: '+c_y+Hitpoints(cur_ship)+c_e+' ('+c_y+ItemSize(item)+c_e+')'+br+' units, skin blocks up to '+br+cl+GetEquipmentStats(item,0)+c_e+' incoming damage.'+br+' Damage susceptibility:'+br+' E:'+c_y+HullDamageSuspectibility(item,0)+c_e+'%  S:'+c_y+HullDamageSuspectibility(item,1)+c_e+'%  M:'+c_y+HullDamageSuspectibility(item,2)+c_e+'%.';
                                    3=InterfaceState('Ship','w_Hull',1);
                                    5=InterfaceText('Ship','text_Hull',text);
                                    5=InterfaceText('Ship','size_Hull',ItemSize(item));
                                    5=InterfaceText('Ship','cost_Hull',ItemCost(item));
                                    7=if(ItemOwner(item)!=5)InterfaceImage('Ship','race_Hull','GI,Bm.FormRace.2w_Race_'+ItemOwner(item));
                                    7=if(ItemOwner(item)==5)InterfaceImage('Ship','race_Hull','GI,Bm.FormRace.2w_Race_'+ItemOwner(item)+'_'+ItemSubrace(item));
                                    8=for(i=1;i<9;i=i+1)
                                    8 ^{
                                        0=slot=GetEquipmentStats(item,i);
                                        0=int open=0;
                                        1=if(i==3)InterfaceState('Ship','InfoHull_Radar_off',(slot!=1));
                                        1=if(i==4)InterfaceState('Ship','InfoHull_Scaner_off',(slot!=1));
                                        1=if(i==5)InterfaceState('Ship','InfoHull_RepairRobot_off',(slot!=1));
                                        1=if(i==6)InterfaceState('Ship','InfoHull_CargoHook_off',(slot!=1));
                                        1=if(i==7)InterfaceState('Ship','InfoHull_DefGenerator_off',(slot!=1));
                                        1=if(i==8)InterfaceState('Ship','InfoHull_Forsage_on',(slot!=0));
                                        2=if(i==1)
                                        2 ^{
                                            0=InterfaceState('Ship','InfoHull_W1_off',1);
                                            0=InterfaceState('Ship','InfoHull_W2_off',1);
                                            0=InterfaceState('Ship','InfoHull_W3_off',1);
                                            0=InterfaceState('Ship','InfoHull_W4_off',1);
                                            0=InterfaceState('Ship','InfoHull_W5_off',1);
                                            0=open=1;
                                            1=while(open<=slot)
                                            1 ^{
                                                0=InterfaceState('Ship','InfoHull_W'+open+'_off',0);
                                                1=open=open+1;
                                            }
                                        }
                                        3=if(i==2)
                                        3 ^{
                                            0=InterfaceState('Ship','InfoHull_A1_off',1);
                                            0=InterfaceState('Ship','InfoHull_A2_off',1);
                                            0=InterfaceState('Ship','InfoHull_A3_off',1);
                                            0=InterfaceState('Ship','InfoHull_A4_off',1);
                                            0=open=1;
                                            1=while(open<=slot)
                                            1 ^{
                                                0=InterfaceState('Ship','InfoHull_A'+open+'_off',0);
                                                1=open=open+1;
                                            }
                                        }
                                    }
                                }
                                5=for(i=t_FuelTanks;i<t_Weapon1;i=i+1)
                                5 ^{
                                    0=item=ShipEqInSlot(cur_ship,i);
                                    1=if(item)
                                    1 ^{
                                        0=if(ItemImprovement(item) || EqModule(item)>=0)cl='<color=0,255,0>';
                                        0=if(!ItemImprovement(item) && EqModule(item)<0)cl='<color=255,240,100>';
                                        0=if(ItemType(item)==t_FuelTanks)
                                        0 ^{
                                            0=text='Tank capacity: '+cl+GetEquipmentStats(item,0)+c_e+'. Fuel amount: '+c_y+ContainerFuel(item)+c_e+'.';
                                            1=if(ItemOwner(item)<=4 || ItemOwner(item)==6)InterfaceImage('Ship','img_FuelTanks','GI,Bm.Items.2FuelTanks'+(ItemLevel(item)-1)+'s');
                                            2=if(ItemOwner(item)==5)InterfaceImage('Ship','img_FuelTanks','GI,Bm.Items.2FuelTanksKling0s');
                                            3=if(EqSpecial(item)>=0 && ItemOwner(item)!=5)InterfaceImage('Ship','img_FuelTanks','GI,Bm.Items.2FuelTanks'+CT('MicroModuls.'+BonusNumInCfg(EqSpecial(item))+'.KindGraph')+'s');
                                            4=InterfaceText('Ship','text_FuelTanks',text);
                                            4=InterfaceText('Ship','size_FuelTanks',ItemSize(item));
                                            4=InterfaceText('Ship','cost_FuelTanks',ItemCost(item));
                                            5=InterfaceState('Ship','w_FuelTanks',1);
                                            6=InterfaceText('Ship','name_FuelTanks',ItemFullName(item));
                                            7=if(ItemOwner(item)!=5)InterfaceImage('Ship','race_FuelTanks','GI,Bm.FormRace.2w_Race_'+ItemOwner(item));
                                            7=if(ItemOwner(item)==5)InterfaceImage('Ship','race_FuelTanks','GI,Bm.FormRace.2w_Race_'+ItemOwner(item)+'_'+ItemSubrace(item));
                                        }
                                        0=if(ItemType(item)==t_Engine)
                                        0 ^{
                                            0=text='Allows for a top speed of '+cl+GetEquipmentStats(item,0)+c_e+' units and a hyperjump range of '+cl+GetEquipmentStats(item,1)+c_e+' parsecs.';
                                            1=if(ItemOwner(item)<=4 || ItemOwner(item)==6)InterfaceImage('Ship','img_Engine','GI,Bm.Items.2Engine'+(ItemLevel(item)-1)+'s');
                                            2=if(ItemOwner(item)==5)InterfaceImage('Ship','img_Engine','GI,Bm.Items.2EngineKling0s');
                                            3=if(EqSpecial(item)>=0 && ItemOwner(item)!=5)InterfaceImage('Ship','img_Engine','GI,Bm.Items.2Engine'+CT('MicroModuls.'+BonusNumInCfg(EqSpecial(item))+'.KindGraph')+'s');
                                            4=InterfaceText('Ship','text_Engine',text);
                                            4=InterfaceText('Ship','size_Engine',ItemSize(item));
                                            4=InterfaceText('Ship','cost_Engine',ItemCost(item));
                                            5=InterfaceState('Ship','w_Engine',1);
                                            6=InterfaceText('Ship','name_Engine',ItemFullName(item));
                                            7=if(ItemOwner(item)!=5)InterfaceImage('Ship','race_Engine','GI,Bm.FormRace.2w_Race_'+ItemOwner(item));
                                            7=if(ItemOwner(item)==5)InterfaceImage('Ship','race_Engine','GI,Bm.FormRace.2w_Race_'+ItemOwner(item)+'_'+ItemSubrace(item));
                                        }
                                        0=if(ItemType(item)==t_Radar)
                                        0 ^{
                                            0=text='Picks up data about objects within a radius of '+cl+GetEquipmentStats(item,0)+c_e+' million kilometers.';
                                            1=if(ItemOwner(item)<=4 || ItemOwner(item)==6)InterfaceImage('Ship','img_Radar','GI,Bm.Items.2Radar'+(ItemLevel(item)-1)+'s');
                                            2=if(ItemOwner(item)==5)InterfaceImage('Ship','img_Radar','GI,Bm.Items.2RadarKling0s');
                                            3=if(EqSpecial(item)>=0 && ItemOwner(item)!=5)InterfaceImage('Ship','img_Radar','GI,Bm.Items.2Radar'+CT('MicroModuls.'+BonusNumInCfg(EqSpecial(item))+'.KindGraph')+'s');
                                            4=InterfaceText('Ship','text_Radar',text);
                                            4=InterfaceText('Ship','size_Radar',ItemSize(item));
                                            4=InterfaceText('Ship','cost_Radar',ItemCost(item));
                                            5=InterfaceState('Ship','w_Radar',1);
                                            6=InterfaceText('Ship','name_Radar',ItemFullName(item));
                                            7=if(ItemOwner(item)!=5)InterfaceImage('Ship','race_Radar','GI,Bm.FormRace.2w_Race_'+ItemOwner(item));
                                            7=if(ItemOwner(item)==5)InterfaceImage('Ship','race_Radar','GI,Bm.FormRace.2w_Race_'+ItemOwner(item)+'_'+ItemSubrace(item));
                                        }
                                        0=if(ItemType(item)==t_Scaner)
                                        0 ^{
                                            0=text='Scans for objects with a shield generator at less than '+cl+GetEquipmentStats(item,0)+c_e+'%';
                                            1=if(ItemOwner(item)<=4 || ItemOwner(item)==6)InterfaceImage('Ship','img_Scaner','GI,Bm.Items.2Scaner'+(ItemLevel(item)-1)+'s');
                                            2=if(ItemOwner(item)==5)InterfaceImage('Ship','img_Scaner','GI,Bm.Items.2ScanerKling0s');
                                            3=if(EqSpecial(item)>=0 && ItemOwner(item)!=5)InterfaceImage('Ship','img_Scaner','GI,Bm.Items.2Scaner'+CT('MicroModuls.'+BonusNumInCfg(EqSpecial(item))+'.KindGraph')+'s');
                                            4=InterfaceText('Ship','text_Scaner',text);
                                            4=InterfaceText('Ship','size_Scaner',ItemSize(item));
                                            4=InterfaceText('Ship','cost_Scaner',ItemCost(item));
                                            5=InterfaceState('Ship','w_Scaner',1);
                                            6=InterfaceText('Ship','name_Scaner',ItemFullName(item));
                                            7=if(ItemOwner(item)!=5)InterfaceImage('Ship','race_Scaner','GI,Bm.FormRace.2w_Race_'+ItemOwner(item));
                                            7=if(ItemOwner(item)==5)InterfaceImage('Ship','race_Scaner','GI,Bm.FormRace.2w_Race_'+ItemOwner(item)+'_'+ItemSubrace(item));
                                        }
                                        0=if(ItemType(item)==t_RepairRobot)
                                        0 ^{
                                            0=text='Restores '+cl+GetEquipmentStats(item,0)+c_e+' hit points to the ship skin.';
                                            1=if(ItemOwner(item)<=4 || ItemOwner(item)==6)InterfaceImage('Ship','img_RepairRobot','GI,Bm.Items.2RepairRobot'+(ItemLevel(item)-1)+'s');
                                            2=if(ItemOwner(item)==5)InterfaceImage('Ship','img_RepairRobot','GI,Bm.Items.2RepairRobotKling0s');
                                            3=if(EqSpecial(item)>=0 && ItemOwner(item)!=5)InterfaceImage('Ship','img_RepairRobot','GI,Bm.Items.2RepairRobot'+CT('MicroModuls.'+BonusNumInCfg(EqSpecial(item))+'.KindGraph')+'s');
                                            4=InterfaceText('Ship','text_RepairRobot',text);
                                            4=InterfaceText('Ship','size_RepairRobot',ItemSize(item));
                                            4=InterfaceText('Ship','cost_RepairRobot',ItemCost(item));
                                            5=InterfaceState('Ship','w_RepairRobot',1);
                                            6=InterfaceText('Ship','name_RepairRobot',ItemFullName(item));
                                            7=if(ItemOwner(item)!=5)InterfaceImage('Ship','race_RepairRobot','GI,Bm.FormRace.2w_Race_'+ItemOwner(item));
                                            7=if(ItemOwner(item)==5)InterfaceImage('Ship','race_RepairRobot','GI,Bm.FormRace.2w_Race_'+ItemOwner(item)+'_'+ItemSubrace(item));
                                        }
                                        0=if(ItemType(item)==t_CargoHook)
                                        0 ^{
                                            0=text='Grips small objects up to '+cl+GetEquipmentStats(item,0)+c_e+' units n size within a radius of '+cl+GetEquipmentStats(item,1)+c_e+'.';
                                            1=if(ItemOwner(item)<=4 || ItemOwner(item)==6)InterfaceImage('Ship','img_CargoHook','GI,Bm.Items.2CargoHook'+(ItemLevel(item)-1)+'s');
                                            2=if(ItemOwner(item)==5)InterfaceImage('Ship','img_CargoHook','GI,Bm.Items.2CargoHookKling0s');
                                            3=if(EqSpecial(item)>=0 && ItemOwner(item)!=5)InterfaceImage('Ship','img_CargoHook','GI,Bm.Items.2CargoHook'+CT('MicroModuls.'+BonusNumInCfg(EqSpecial(item))+'.KindGraph')+'s');
                                            4=InterfaceText('Ship','text_CargoHook',text);
                                            4=InterfaceText('Ship','size_CargoHook',ItemSize(item));
                                            4=InterfaceText('Ship','cost_CargoHook',ItemCost(item));
                                            5=InterfaceState('Ship','w_CargoHook',1);
                                            6=InterfaceText('Ship','name_CargoHook',ItemFullName(item));
                                            7=if(ItemOwner(item)!=5)InterfaceImage('Ship','race_CargoHook','GI,Bm.FormRace.2w_Race_'+ItemOwner(item));
                                            7=if(ItemOwner(item)==5)InterfaceImage('Ship','race_CargoHook','GI,Bm.FormRace.2w_Race_'+ItemOwner(item)+'_'+ItemSubrace(item));
                                        }
                                        0=if(ItemType(item)==t_DefGenerator)
                                        0 ^{
                                            0=text='Blocks '+cl+GetEquipmentStats(item,0)+c_e+'% of incoming damage.';
                                            1=if(ItemOwner(item)<=4 || ItemOwner(item)==6)InterfaceImage('Ship','img_DefGenerator','GI,Bm.Items.2DefGenerator'+(ItemLevel(item)-1)+'s');
                                            2=if(ItemOwner(item)==5)InterfaceImage('Ship','img_DefGenerator','GI,Bm.Items.2DefGeneratorKling0s');
                                            3=if(EqSpecial(item)>=0 && ItemOwner(item)!=5)InterfaceImage('Ship','img_DefGenerator','GI,Bm.Items.2DefGenerator'+CT('MicroModuls.'+BonusNumInCfg(EqSpecial(item))+'.KindGraph')+'s');
                                            4=InterfaceText('Ship','text_DefGenerator',text);
                                            4=InterfaceText('Ship','size_DefGenerator',ItemSize(item));
                                            4=InterfaceText('Ship','cost_DefGenerator',ItemCost(item));
                                            5=InterfaceState('Ship','w_DefGenerator',1);
                                            6=InterfaceText('Ship','name_DefGenerator',ItemFullName(item));
                                            7=if(ItemOwner(item)!=5)InterfaceImage('Ship','race_DefGenerator','GI,Bm.FormRace.2w_Race_'+ItemOwner(item));
                                            7=if(ItemOwner(item)==5)InterfaceImage('Ship','race_DefGenerator','GI,Bm.FormRace.2w_Race_'+ItemOwner(item)+'_'+ItemSubrace(item));
                                        }
                                    }
                                }
                                6=for(i=1;i<6;i=i+1)
                                6 ^{
                                    0=item=ShipEqInSlot(cur_ship,t_Weapon1,i);
                                    1=if(item)
                                    1 ^{
                                        0=item=ShipEqInSlot(cur_ship,t_Weapon1,i);
                                        0=if(ItemType(item)!=t_CustomWeapon)text=CT('Items.Weapon.Text.'+(ItemType(item)-t_DefGenerator));
                                        0=if(ItemType(item)==t_CustomWeapon)text=CT('Items.Weapon.Text.'+CustomWeaponType(item));
                                        0=if(count(text)<122)
                                        0 ^{
                                            0=move_x=-120;
                                            1=move_y=-150;
                                            2=InterfaceSize('Ship','text_Weapon_'+i,0,0);
                                        }
                                        0=if(count(text)>=122 && count(text)<147)
                                        0 ^{
                                            0=move_x=-105;
                                            0=move_y=-145;
                                            2=InterfaceSize('Ship','text_Weapon_'+i,225,0);
                                        }
                                        0=if(count(text)>=147 && count(text)<186)
                                        0 ^{
                                            0=move_x=-90;
                                            0=move_y=-140;
                                            2=InterfaceSize('Ship','text_Weapon_'+i,245,0);
                                        }
                                        0=if(count(text)>=186 && count(text)<219)
                                        0 ^{
                                            0=move_x=-85;
                                            0=move_y=-132;
                                            2=InterfaceSize('Ship','text_Weapon_'+i,255,0);
                                        }
                                        0=if(count(text)>=219 && count(text)<265)
                                        0 ^{
                                            0=move_x=-75;
                                            0=move_y=-121;
                                            2=InterfaceSize('Ship','text_Weapon_'+i,255,0);
                                        }
                                        0=if(count(text)>=265 && count(text)<314)
                                        0 ^{
                                            0=move_x=-75;
                                            0=move_y=-95;
                                            2=InterfaceSize('Ship','text_Weapon_'+i,255,0);
                                        }
                                        0=if(count(text)>=314)
                                        0 ^{
                                            0=move_x=-45;
                                            0=move_y=-95;
                                            2=InterfaceSize('Ship','text_Weapon_'+i,285,0);
                                        }
                                        0=add_int=GetEquipmentStats(item,5);
                                        1=if(ItemImprovement(item) || EqModule(item)>=0)text=Format(text,'<CntAttacks>',GetEquipmentStats(item,4),'<MinDamage>',GetEquipmentStats(item,1),'<MaxDamage>','<color=0,255,0>'+GetEquipmentStats(item,0)+'</color>','<Radius>','<color=0,255,0>'+GetEquipmentStats(item,2)+'</color>','<Count>',WeaponAmmunition(item),'<MaxCount>',WeaponMaxAmmunition(item),'<CntShots>',add_int);
                                        1=if(!ItemImprovement(item) && EqModule(item)<0)text=Format(text,'<CntAttacks>',GetEquipmentStats(item,4),'<MinDamage>',GetEquipmentStats(item,1),'<MaxDamage>',GetEquipmentStats(item,0),'<Radius>',GetEquipmentStats(item,2),'<Count>',WeaponAmmunition(item),'<MaxCount>',WeaponMaxAmmunition(item),'<CntShots>',add_int);
                                        1=if(ItemType(item)<t_Weapon10)ts='0'+(ItemType(item)-t_DefGenerator);
                                        1=if(ItemType(item)>=t_Weapon10)ts=''+(ItemType(item)-t_DefGenerator);
                                        2=if(EqSpecial(item)<0 && ItemType(item)!=t_CustomWeapon)InterfaceImage('Ship','img_Weapon_'+i,'GI,Bm.Items.2W'+ts+'s');
                                        2=if(EqSpecial(item)<0 && ItemType(item)==t_CustomWeapon)InterfaceImage('Ship','img_Weapon_'+i,'GI,Bm.Items.2W'+CustomWeaponType(item)+'s');
                                        2=InterfaceText('Ship','name_Weapon_'+i,ItemFullName(item));
                                        2=InterfaceSize('Ship','name_Weapon_'+i,165+(120+move_x),0);
                                        3=if(EqSpecial(item)>=0)
                                        3 ^{
                                            0=if(ItemType(item)!=t_CustomWeapon)InterfaceImage('Ship','img_Weapon_'+i,'GI,Bm.Items.2W'+ts+CT('MicroModuls.'+BonusNumInCfg(EqSpecial(item))+'.KindGraph')+'s');
                                            1=else InterfaceImage('Ship','img_Weapon_'+i,'GI,Bm.Items.2W'+CustomWeaponType(item)+'s');
                                            2=InterfaceText('Ship','name_Weapon_'+i,ItemFullName(item)+' '+BonusName(EqSpecial(item)));
                                        }
                                        4=InterfaceText('Ship','text_Weapon_'+i,text);
                                        4=InterfaceText('Ship','size_Weapon_'+i,ItemSize(item));
                                        4=InterfaceText('Ship','cost_Weapon_'+i,ItemCost(item));
                                        5=InterfaceState('Ship','w_Weapon_'+i,1);
                                        7=if(ItemOwner(item)!=5)InterfaceImage('Ship','race_Weapon_'+i,'GI,Bm.FormRace.2w_Race_'+ItemOwner(item));
                                        7=if(ItemOwner(item)==5)InterfaceImage('Ship','race_Weapon_'+i,'GI,Bm.FormRace.2w_Race_'+ItemOwner(item)+'_'+ItemSubrace(item));
                                        8=InterfacePos('Ship','tr_Weapon_'+i,move_x,0,0);
                                        8=InterfacePos('Ship','br_Weapon_'+i,move_x,move_y,0);
                                        8=InterfacePos('Ship','race_Weapon_'+i,move_x,move_y,0);
                                        8=InterfaceSize('Ship','p_Weapon_'+i,336+move_x,0);
                                        8=InterfacePos('Ship','bl_Weapon_'+i,0,move_y,0);
                                        8=InterfacePos('Ship','c_Weapon_'+i,move_x,move_y,0);
                                        8=InterfacePos('Ship','size_Weapon_'+i,0,move_y,0);
                                        8=InterfacePos('Ship','cost_Weapon_'+i,0,move_y,0);
                                    }
                                }
                            }
                            OnMouseLeaveCode ^{
                                0=InterfaceState('Ship','w_Hull',0);
                                0=InterfaceState('Ship','w_FuelTanks',0);
                                0=InterfaceState('Ship','w_Engine',0);
                                0=InterfaceState('Ship','w_Radar',0);
                                0=InterfaceState('Ship','w_Scaner',0);
                                0=InterfaceState('Ship','w_RepairRobot',0);
                                0=InterfaceState('Ship','w_CargoHook',0);
                                0=InterfaceState('Ship','w_DefGenerator',0);
                                0=InterfaceState('Ship','w_Weapon_1',0);
                                0=InterfaceState('Ship','w_Weapon_2',0);
                                0=InterfaceState('Ship','w_Weapon_3',0);
                                0=InterfaceState('Ship','w_Weapon_4',0);
                                0=InterfaceState('Ship','w_Weapon_5',0);
                            }
                            Pos=15,51,0
                            Size=35,33
                        }
                        Name=AstAddShip
                        Pos=967,541,-10
                        PosAutoCorrection=True
                        PosAutoCorrectionXCoef=1
                        PosAutoCorrectionYCoef=1
                        Size=57,100
                    }
                    Panel ^{
                        Active=False
                        Image ^{
                            Image=GI,Bm.Items.2Hull_People_R_s
                            Name=img_Weapon_1
                            Pos=16,14,0
                            Size=35,35
                        }
                        Image ^{
                            Image=GI,Bm.FormInfo3.2CW_tl
                            Name=tl_Weapon_1
                            Pos=0,0,6
                            Size=118,59
                        }
                        Image ^{
                            Image=GI,Bm.FormInfo3.2CW_p
                            Name=p_Weapon_1
                            Pos=16,59,6
                            Size=336,6
                        }
                        Label ^{
                            AlignX=Left
                            AlignY=CenterEx
                            Font=Font.2Normal
                            Name=size_Weapon_1
                            Pos=49,270,0
                            Size=45,33
                            TextColor=255,255,255
                            WordWrap=True
                        }
                        Label ^{
                            AlignX=Left
                            AlignY=CenterEx
                            Font=Font.2Normal
                            Name=cost_Weapon_1
                            Pos=117,270,0
                            Size=100,33
                            TextColor=255,255,255
                            WordWrap=True
                        }
                        Label ^{
                            AlignX=Center
                            AlignY=CenterEx
                            Font=Font.2SmallBold
                            Name=name_Weapon_1
                            Pos=60,13,0
                            Size=165,40
                            TextColor=57,239,255
                            WordWrap=True
                        }
                        Label ^{
                            AlignX=Center
                            AlignY=Top
                            Font=Font.2Small
                            Name=text_Weapon_1
                            Pos=24,64,0
                            Size=205,200
                            TextColor=255,255,255
                            WordWrap=True
                        }
                        Name=w_Weapon_1
                        Panel ^{
                            Image ^{
                                Image=GI,Bm.FormInfo3.2CW_tr
                                Name=tr_Weapon_1
                                Pos=0,0,6
                                Size=250,59
                            }
                            Image ^{
                                Image=GI,Bm.FormInfo3.2BRacePeopleN
                                Name=race_Weapon_1
                                Pos=200,268,0
                                Size=35,35
                            }
                            Name=mp_Weapon_1
                            Pos=118,0,6
                            Size=368,309
                        }
                        Panel ^{
                            Image ^{
                                Image=GI,Bm.FormInfo3.2CW_bl
                                Name=bl_Weapon_1
                                Pos=0,0,6
                                Size=118,250
                            }
                            Name=mp_2_Weapon_1
                            Pos=0,59,6
                            Size=118,250
                        }
                        Panel ^{
                            Image ^{
                                Image=GI,Bm.FormInfo3.2CW_c
                                Name=c_Weapon_1
                                Pos=0,0,6
                                Size=336,206
                            }
                            Name=mp_3_Weapon_1
                            Pos=16,65,6
                            Size=336,206
                        }
                        Panel ^{
                            Image ^{
                                Image=GI,Bm.FormInfo3.2CW_br
                                Name=br_Weapon_1
                                Pos=0,0,6
                                Size=250,250
                            }
                            Name=mp_4_Weapon_1
                            Pos=118,59,6
                            Size=250,250
                        }
                        Pos=30,195,3
                        PosAutoCorrection=True
                        PosAutoCorrectionXCoef=0.5
                        PosAutoCorrectionYCoef=0.5
                        Size=368,309
                    }
                    Panel ^{
                        Active=False
                        Image ^{
                            Image=GI,Bm.Items.2Hull_People_R_s
                            Name=img_Weapon_2
                            Pos=16,14,0
                            Size=35,35
                        }
                        Image ^{
                            Image=GI,Bm.FormInfo3.2CW_tl
                            Name=tl_Weapon_2
                            Pos=0,0,6
                            Size=118,59
                        }
                        Image ^{
                            Image=GI,Bm.FormInfo3.2CW_p
                            Name=p_Weapon_2
                            Pos=16,59,6
                            Size=336,6
                        }
                        Label ^{
                            AlignX=Left
                            AlignY=CenterEx
                            Font=Font.2Normal
                            Name=size_Weapon_2
                            Pos=49,270,0
                            Size=45,33
                            TextColor=255,255,255
                            WordWrap=True
                        }
                        Label ^{
                            AlignX=Left
                            AlignY=CenterEx
                            Font=Font.2Normal
                            Name=cost_Weapon_2
                            Pos=117,270,0
                            Size=100,33
                            TextColor=255,255,255
                            WordWrap=True
                        }
                        Label ^{
                            AlignX=Center
                            AlignY=CenterEx
                            Font=Font.2SmallBold
                            Name=name_Weapon_2
                            Pos=60,13,0
                            Size=165,40
                            TextColor=57,239,255
                            WordWrap=True
                        }
                        Label ^{
                            AlignX=Center
                            AlignY=Top
                            Font=Font.2Small
                            Name=text_Weapon_2
                            Pos=24,64,0
                            Size=205,200
                            TextColor=255,255,255
                            WordWrap=True
                        }
                        Name=w_Weapon_2
                        Panel ^{
                            Image ^{
                                Image=GI,Bm.FormInfo3.2CW_tr
                                Name=tr_Weapon_2
                                Pos=0,0,6
                                Size=250,59
                            }
                            Image ^{
                                Image=GI,Bm.FormInfo3.2BRacePeopleN
                                Name=race_Weapon_2
                                Pos=200,268,0
                                Size=35,35
                            }
                            Name=mp_Weapon_2
                            Pos=118,0,6
                            Size=368,309
                        }
                        Panel ^{
                            Image ^{
                                Image=GI,Bm.FormInfo3.2CW_bl
                                Name=bl_Weapon_2
                                Pos=0,0,6
                                Size=118,250
                            }
                            Name=mp_2_Weapon_2
                            Pos=0,59,6
                            Size=118,250
                        }
                        Panel ^{
                            Image ^{
                                Image=GI,Bm.FormInfo3.2CW_c
                                Name=c_Weapon_2
                                Pos=0,0,6
                                Size=336,206
                            }
                            Name=mp_3_Weapon_2
                            Pos=16,65,6
                            Size=336,206
                        }
                        Panel ^{
                            Image ^{
                                Image=GI,Bm.FormInfo3.2CW_br
                                Name=br_Weapon_2
                                Pos=0,0,6
                                Size=250,250
                            }
                            Name=mp_4_Weapon_2
                            Pos=118,59,6
                            Size=250,250
                        }
                        Pos=335,195,3
                        PosAutoCorrection=True
                        PosAutoCorrectionXCoef=0.5
                        PosAutoCorrectionYCoef=0.5
                        Size=368,309
                    }
                    Panel ^{
                        Active=False
                        Image ^{
                            Image=GI,Bm.Items.2Hull_People_R_s
                            Name=img_Weapon_3
                            Pos=16,14,0
                            Size=35,35
                        }
                        Image ^{
                            Image=GI,Bm.FormInfo3.2CW_tl
                            Name=tl_Weapon_3
                            Pos=0,0,6
                            Size=118,59
                        }
                        Image ^{
                            Image=GI,Bm.FormInfo3.2CW_p
                            Name=p_Weapon_3
                            Pos=16,59,6
                            Size=336,6
                        }
                        Label ^{
                            AlignX=Left
                            AlignY=CenterEx
                            Font=Font.2Normal
                            Name=size_Weapon_3
                            Pos=49,270,0
                            Size=45,33
                            TextColor=255,255,255
                            WordWrap=True
                        }
                        Label ^{
                            AlignX=Left
                            AlignY=CenterEx
                            Font=Font.2Normal
                            Name=cost_Weapon_3
                            Pos=117,270,0
                            Size=100,33
                            TextColor=255,255,255
                            WordWrap=True
                        }
                        Label ^{
                            AlignX=Center
                            AlignY=CenterEx
                            Font=Font.2SmallBold
                            Name=name_Weapon_3
                            Pos=60,13,0
                            Size=165,40
                            TextColor=57,239,255
                            WordWrap=True
                        }
                        Label ^{
                            AlignX=Center
                            AlignY=Top
                            Font=Font.2Small
                            Name=text_Weapon_3
                            Pos=24,64,0
                            Size=205,200
                            TextColor=255,255,255
                            WordWrap=True
                        }
                        Name=w_Weapon_3
                        Panel ^{
                            Image ^{
                                Image=GI,Bm.FormInfo3.2CW_tr
                                Name=tr_Weapon_3
                                Pos=0,0,6
                                Size=250,59
                            }
                            Image ^{
                                Image=GI,Bm.FormInfo3.2BRacePeopleN
                                Name=race_Weapon_3
                                Pos=200,268,0
                                Size=35,35
                            }
                            Name=mp_Weapon_3
                            Pos=118,0,6
                            Size=368,309
                        }
                        Panel ^{
                            Image ^{
                                Image=GI,Bm.FormInfo3.2CW_bl
                                Name=bl_Weapon_3
                                Pos=0,0,6
                                Size=118,250
                            }
                            Name=mp_2_Weapon_3
                            Pos=0,59,6
                            Size=118,250
                        }
                        Panel ^{
                            Image ^{
                                Image=GI,Bm.FormInfo3.2CW_c
                                Name=c_Weapon_3
                                Pos=0,0,6
                                Size=336,206
                            }
                            Name=mp_3_Weapon_3
                            Pos=16,65,6
                            Size=336,206
                        }
                        Panel ^{
                            Image ^{
                                Image=GI,Bm.FormInfo3.2CW_br
                                Name=br_Weapon_3
                                Pos=0,0,6
                                Size=250,250
                            }
                            Name=mp_4_Weapon_3
                            Pos=118,59,6
                            Size=250,250
                        }
                        Pos=640,195,3
                        PosAutoCorrection=True
                        PosAutoCorrectionXCoef=0.5
                        PosAutoCorrectionYCoef=0.5
                        Size=368,309
                    }
                    Panel ^{
                        Active=False
                        Image ^{
                            Image=GI,Bm.Items.2Hull_People_R_s
                            Name=img_Weapon_4
                            Pos=16,14,0
                            Size=35,35
                        }
                        Image ^{
                            Image=GI,Bm.FormInfo3.2CW_tl
                            Name=tl_Weapon_4
                            Pos=0,0,6
                            Size=118,59
                        }
                        Image ^{
                            Image=GI,Bm.FormInfo3.2CW_p
                            Name=p_Weapon_4
                            Pos=16,59,6
                            Size=336,6
                        }
                        Label ^{
                            AlignX=Left
                            AlignY=CenterEx
                            Font=Font.2Normal
                            Name=size_Weapon_4
                            Pos=49,270,0
                            Size=45,33
                            TextColor=255,255,255
                            WordWrap=True
                        }
                        Label ^{
                            AlignX=Left
                            AlignY=CenterEx
                            Font=Font.2Normal
                            Name=cost_Weapon_4
                            Pos=117,270,0
                            Size=100,33
                            TextColor=255,255,255
                            WordWrap=True
                        }
                        Label ^{
                            AlignX=Center
                            AlignY=CenterEx
                            Font=Font.2SmallBold
                            Name=name_Weapon_4
                            Pos=60,13,0
                            Size=165,40
                            TextColor=57,239,255
                            WordWrap=True
                        }
                        Label ^{
                            AlignX=Center
                            AlignY=Top
                            Font=Font.2Small
                            Name=text_Weapon_4
                            Pos=24,64,0
                            Size=205,200
                            TextColor=255,255,255
                            WordWrap=True
                        }
                        Name=w_Weapon_4
                        Panel ^{
                            Image ^{
                                Image=GI,Bm.FormInfo3.2CW_tr
                                Name=tr_Weapon_4
                                Pos=0,0,6
                                Size=250,59
                            }
                            Image ^{
                                Image=GI,Bm.FormInfo3.2BRacePeopleN
                                Name=race_Weapon_4
                                Pos=200,268,0
                                Size=35,35
                            }
                            Name=mp_Weapon_4
                            Pos=118,0,6
                            Size=368,309
                        }
                        Panel ^{
                            Image ^{
                                Image=GI,Bm.FormInfo3.2CW_bl
                                Name=bl_Weapon_4
                                Pos=0,0,6
                                Size=118,250
                            }
                            Name=mp_2_Weapon_4
                            Pos=0,59,6
                            Size=118,250
                        }
                        Panel ^{
                            Image ^{
                                Image=GI,Bm.FormInfo3.2CW_c
                                Name=c_Weapon_4
                                Pos=0,0,6
                                Size=336,206
                            }
                            Name=mp_3_Weapon_4
                            Pos=16,65,6
                            Size=336,206
                        }
                        Panel ^{
                            Image ^{
                                Image=GI,Bm.FormInfo3.2CW_br
                                Name=br_Weapon_4
                                Pos=0,0,6
                                Size=250,250
                            }
                            Name=mp_4_Weapon_4
                            Pos=118,59,6
                            Size=250,250
                        }
                        Pos=30,0,2
                        PosAutoCorrection=True
                        PosAutoCorrectionXCoef=0.5
                        PosAutoCorrectionYCoef=0.5
                        Size=368,309
                    }
                    Panel ^{
                        Active=False
                        Image ^{
                            Image=GI,Bm.Items.2Hull_People_R_s
                            Name=img_Weapon_5
                            Pos=16,14,0
                            Size=35,35
                        }
                        Image ^{
                            Image=GI,Bm.FormInfo3.2CW_tl
                            Name=tl_Weapon_5
                            Pos=0,0,6
                            Size=118,59
                        }
                        Image ^{
                            Image=GI,Bm.FormInfo3.2CW_p
                            Name=p_Weapon_5
                            Pos=16,59,6
                            Size=336,6
                        }
                        Label ^{
                            AlignX=Left
                            AlignY=CenterEx
                            Font=Font.2Normal
                            Name=size_Weapon_5
                            Pos=49,270,0
                            Size=45,33
                            TextColor=255,255,255
                            WordWrap=True
                        }
                        Label ^{
                            AlignX=Left
                            AlignY=CenterEx
                            Font=Font.2Normal
                            Name=cost_Weapon_5
                            Pos=117,270,0
                            Size=100,33
                            TextColor=255,255,255
                            WordWrap=True
                        }
                        Label ^{
                            AlignX=Center
                            AlignY=CenterEx
                            Font=Font.2SmallBold
                            Name=name_Weapon_5
                            Pos=60,13,0
                            Size=165,40
                            TextColor=57,239,255
                            WordWrap=True
                        }
                        Label ^{
                            AlignX=Center
                            AlignY=Top
                            Font=Font.2Small
                            Name=text_Weapon_5
                            Pos=24,64,0
                            Size=205,200
                            TextColor=255,255,255
                            WordWrap=True
                        }
                        Name=w_Weapon_5
                        Panel ^{
                            Image ^{
                                Image=GI,Bm.FormInfo3.2CW_tr
                                Name=tr_Weapon_5
                                Pos=0,0,6
                                Size=250,59
                            }
                            Image ^{
                                Image=GI,Bm.FormInfo3.2BRacePeopleN
                                Name=race_Weapon_5
                                Pos=200,268,0
                                Size=35,35
                            }
                            Name=mp_Weapon_5
                            Pos=118,0,6
                            Size=368,309
                        }
                        Panel ^{
                            Image ^{
                                Image=GI,Bm.FormInfo3.2CW_bl
                                Name=bl_Weapon_5
                                Pos=0,0,6
                                Size=118,250
                            }
                            Name=mp_2_Weapon_5
                            Pos=0,59,6
                            Size=118,250
                        }
                        Panel ^{
                            Image ^{
                                Image=GI,Bm.FormInfo3.2CW_c
                                Name=c_Weapon_5
                                Pos=0,0,6
                                Size=336,206
                            }
                            Name=mp_3_Weapon_5
                            Pos=16,65,6
                            Size=336,206
                        }
                        Panel ^{
                            Image ^{
                                Image=GI,Bm.FormInfo3.2CW_br
                                Name=br_Weapon_5
                                Pos=0,0,6
                                Size=250,250
                            }
                            Name=mp_4_Weapon_5
                            Pos=118,59,6
                            Size=250,250
                        }
                        Pos=335,0,2
                        PosAutoCorrection=True
                        PosAutoCorrectionXCoef=0.5
                        PosAutoCorrectionYCoef=0.5
                        Size=368,309
                    }
                    Window ^{
                        Active=False
                        Image ^{
                            Image=GI,Bm.FormRace.2w_Race_6
                            Name=img_Hull
                            Pos=17,17,0
                            Size=35,35
                        }
                        Image ^{
                            Image=GI,Bm.FormInfo3.2BRacePeopleN
                            Name=race_Hull
                            Pos=285,130,8
                            Size=35,35
                        }
                        Image ^{
                            Image=GI,Bm.FormNote.2HullBottomLeft
                            Pos=0,103,10
                            Size=265,72
                        }
                        Image ^{
                            Image=GI,Bm.FormNote.2HullBottomRight
                            Pos=263,103,10
                            Size=67,72
                        }
                        Image ^{
                            Image=GI,Bm.FormNote.2ItemBottomRight
                            Pos=115,75,10
                            Size=20,69
                        }
                        Label ^{
                            AlignX=Center
                            AlignY=CenterEx
                            Font=Font.2SmallBold
                            Name=name_Hull
                            Pos=80,13,8
                            Size=200,40
                            TextColor=57,239,255
                            WordWrap=True
                        }
                        Label ^{
                            AlignX=Center
                            AlignY=CenterEx
                            Font=Font.2Small
                            Name=text_Hull
                            Pos=100,55,8
                            Size=240,83
                            TextColor=255,255,255
                            WordWrap=True
                        }
                        Label ^{
                            AlignX=Left
                            AlignY=CenterEx
                            Font=Font.2Normal
                            Name=size_Hull
                            Pos=168,139,8
                            Size=45,33
                            TextColor=255,255,255
                            WordWrap=True
                        }
                        Label ^{
                            AlignX=Left
                            AlignY=CenterEx
                            Font=Font.2Normal
                            Name=cost_Hull
                            Pos=236,139,8
                            Size=100,33
                            TextColor=255,255,255
                            WordWrap=True
                        }
                        Name=w_Hull
                        Panel ^{
                            Image ^{
                                Image=GI,Bm.FormNote.2HP_Bg
                                Pos=0,0,9
                                Size=80,90
                            }
                            Image ^{
                                Image=GI,Bm.FormNote.2HP_Forsage
                                Name=InfoHull_Forsage_on
                                Pos=0,32
                                Size=14,15
                            }
                            Image ^{
                                Active=False
                                Image=GI,Bm.FormNote.2HP_W1
                                Name=InfoHull_W1_off
                                Pos=16,19
                                Size=16,13
                            }
                            Image ^{
                                Active=False
                                Image=GI,Bm.FormNote.2HP_W2
                                Name=InfoHull_W2_off
                                Pos=33,19
                                Size=15,13
                            }
                            Image ^{
                                Active=False
                                Image=GI,Bm.FormNote.2HP_W3
                                Name=InfoHull_W3_off
                                Pos=48,19
                                Size=18,13
                            }
                            Image ^{
                                Active=False
                                Image=GI,Bm.FormNote.2HP_W4
                                Name=InfoHull_W4_off
                                Pos=24,6
                                Size=16,13
                            }
                            Image ^{
                                Active=False
                                Image=GI,Bm.FormNote.2HP_W5
                                Name=InfoHull_W5_off
                                Pos=41,6
                                Size=15,13
                            }
                            Image ^{
                                Active=False
                                Image=GI,Bm.FormNote.2HP_A1
                                Name=InfoHull_A1_off
                                Pos=4,70
                                Size=13,8
                            }
                            Image ^{
                                Active=False
                                Image=GI,Bm.FormNote.2HP_A2
                                Name=InfoHull_A2_off
                                Pos=65,70
                                Size=11,8
                            }
                            Image ^{
                                Active=False
                                Image=GI,Bm.FormNote.2HP_A3
                                Name=InfoHull_A3_off
                                Pos=4,25
                                Size=13,7
                            }
                            Image ^{
                                Active=False
                                Image=GI,Bm.FormNote.2HP_A4
                                Name=InfoHull_A4_off
                                Pos=64,25
                                Size=12,7
                            }
                            Image ^{
                                Active=False
                                Image=GI,Bm.FormNote.2HP_Engine
                                Name=InfoHull_Engine_off
                                Pos=9,36
                                Size=17,14
                            }
                            Image ^{
                                Active=False
                                Image=GI,Bm.FormNote.2HP_FuelTanks
                                Name=InfoHull_FuelTanks_off
                                Pos=9,52
                                Size=17,14
                            }
                            Image ^{
                                Active=False
                                Image=GI,Bm.FormNote.2HP_Scaner
                                Name=InfoHull_Scaner_off
                                Pos=55,36
                                Size=17,14
                            }
                            Image ^{
                                Active=False
                                Image=GI,Bm.FormNote.2HP_Radar
                                Name=InfoHull_Radar_off
                                Pos=55,52
                                Size=17,14
                            }
                            Image ^{
                                Active=False
                                Image=GI,Bm.FormNote.2HP_RepairRobot
                                Name=InfoHull_RepairRobot_off
                                Pos=15,70
                                Size=17,13
                            }
                            Image ^{
                                Active=False
                                Image=GI,Bm.FormNote.2HP_CargoHook
                                Name=InfoHull_CargoHook_off
                                Pos=33,70
                                Size=15,13
                            }
                            Image ^{
                                Active=False
                                Image=GI,Bm.FormNote.2HP_DefGenerator
                                Name=InfoHull_DefGenerator_off
                                Pos=48,70
                                Size=18,13
                            }
                            Name=custom_InfoHull
                            Pos=22,68,7
                            Size=80,90
                        }
                        Pos=660,20,4
                        PosAutoCorrection=True
                        PosAutoCorrectionXCoef=0.5
                        PosAutoCorrectionYCoef=0.5
                        Size=330,175
                        Style=Style.Window.2Simple
                    }
                    Window ^{
                        Active=False
                        Image ^{
                            Image=GI,Bm.Items.2Hull_People_R_s
                            Name=img_Engine
                            Pos=16,14,0
                            Size=35,35
                        }
                        Image ^{
                            Image=GI,Bm.FormInfo3.2BRacePeopleN
                            Name=race_Engine
                            Pos=198,121,8
                            Size=35,35
                        }
                        Image ^{
                            Image=GI,Bm.FormNote.2ItemBottomLeft
                            Pos=0,90,10
                            Size=118,69
                        }
                        Image ^{
                            Image=GI,Bm.FormNote.2ItemBottomRight
                            Pos=130,90,10
                            Size=122,69
                        }
                        Image ^{
                            Image=GI,Bm.FormNote.2ItemBottomRight
                            Pos=115,90,10
                            Size=20,69
                        }
                        Label ^{
                            AlignX=Center
                            AlignY=CenterEx
                            Font=Font.2SmallBold
                            Name=name_Engine
                            Pos=60,13,8
                            Size=165,40
                            TextColor=57,239,255
                            WordWrap=True
                        }
                        Label ^{
                            AlignX=Center
                            AlignY=CenterEx
                            Font=Font.2Small
                            Name=text_Engine
                            Pos=10,45,8
                            Size=220,83
                            TextColor=255,255,255
                            WordWrap=True
                        }
                        Label ^{
                            AlignX=Left
                            AlignY=CenterEx
                            Font=Font.2Normal
                            Name=size_Engine
                            Pos=49,121,8
                            Size=45,33
                            TextColor=255,255,255
                            WordWrap=True
                        }
                        Label ^{
                            AlignX=Left
                            AlignY=CenterEx
                            Font=Font.2Normal
                            Name=cost_Engine
                            Pos=117,121,8
                            Size=100,33
                            TextColor=255,255,255
                            WordWrap=True
                        }
                        Name=w_Engine
                        Pos=5,390,4
                        PosAutoCorrection=True
                        PosAutoCorrectionXCoef=0.5
                        PosAutoCorrectionYCoef=0.5
                        Size=243,158
                        Style=Style.Window.2Simple
                    }
                    Window ^{
                        Active=False
                        Image ^{
                            Image=GI,Bm.Items.2Hull_People_R_s
                            Name=img_FuelTanks
                            Pos=16,14,0
                            Size=35,35
                        }
                        Image ^{
                            Image=GI,Bm.FormInfo3.2BRacePeopleN
                            Name=race_FuelTanks
                            Pos=198,121,8
                            Size=35,35
                        }
                        Image ^{
                            Image=GI,Bm.FormNote.2ItemBottomLeft
                            Pos=0,90,10
                            Size=118,69
                        }
                        Image ^{
                            Image=GI,Bm.FormNote.2ItemBottomRight
                            Pos=130,90,10
                            Size=122,69
                        }
                        Image ^{
                            Image=GI,Bm.FormNote.2ItemBottomRight
                            Pos=115,90,10
                            Size=20,69
                        }
                        Label ^{
                            AlignX=Center
                            AlignY=CenterEx
                            Font=Font.2SmallBold
                            Name=name_FuelTanks
                            Pos=60,13,8
                            Size=165,40
                            TextColor=57,239,255
                            WordWrap=True
                        }
                        Label ^{
                            AlignX=Center
                            AlignY=CenterEx
                            Font=Font.2Small
                            Name=text_FuelTanks
                            Pos=10,45,8
                            Size=220,83
                            TextColor=255,255,255
                            WordWrap=True
                        }
                        Label ^{
                            AlignX=Left
                            AlignY=CenterEx
                            Font=Font.2Normal
                            Name=size_FuelTanks
                            Pos=49,121,8
                            Size=45,33
                            TextColor=255,255,255
                            WordWrap=True
                        }
                        Label ^{
                            AlignX=Left
                            AlignY=CenterEx
                            Font=Font.2Normal
                            Name=cost_FuelTanks
                            Pos=117,121,8
                            Size=100,33
                            TextColor=255,255,255
                            WordWrap=True
                        }
                        Name=w_FuelTanks
                        Pos=250,390,4
                        PosAutoCorrection=True
                        PosAutoCorrectionXCoef=0.5
                        PosAutoCorrectionYCoef=0.5
                        Size=243,158
                        Style=Style.Window.2Simple
                    }
                    Window ^{
                        Active=False
                        Image ^{
                            Image=GI,Bm.Items.2Hull_People_R_s
                            Name=img_Scaner
                            Pos=16,14,0
                            Size=35,35
                        }
                        Image ^{
                            Image=GI,Bm.FormInfo3.2BRacePeopleN
                            Name=race_Scaner
                            Pos=198,121,8
                            Size=35,35
                        }
                        Image ^{
                            Image=GI,Bm.FormNote.2ItemBottomLeft
                            Pos=0,90,10
                            Size=118,69
                        }
                        Image ^{
                            Image=GI,Bm.FormNote.2ItemBottomRight
                            Pos=130,90,10
                            Size=122,69
                        }
                        Image ^{
                            Image=GI,Bm.FormNote.2ItemBottomRight
                            Pos=115,90,10
                            Size=20,69
                        }
                        Label ^{
                            AlignX=Center
                            AlignY=CenterEx
                            Font=Font.2SmallBold
                            Name=name_Scaner
                            Pos=60,13,8
                            Size=165,40
                            TextColor=57,239,255
                            WordWrap=True
                        }
                        Label ^{
                            AlignX=Center
                            AlignY=CenterEx
                            Font=Font.2Small
                            Name=text_Scaner
                            Pos=15,45,8
                            Size=210,83
                            TextColor=255,255,255
                            WordWrap=True
                        }
                        Label ^{
                            AlignX=Left
                            AlignY=CenterEx
                            Font=Font.2Normal
                            Name=size_Scaner
                            Pos=49,121,8
                            Size=45,33
                            TextColor=255,255,255
                            WordWrap=True
                        }
                        Label ^{
                            AlignX=Left
                            AlignY=CenterEx
                            Font=Font.2Normal
                            Name=cost_Scaner
                            Pos=117,121,8
                            Size=100,33
                            TextColor=255,255,255
                            WordWrap=True
                        }
                        Name=w_Scaner
                        Pos=495,390,4
                        PosAutoCorrection=True
                        PosAutoCorrectionXCoef=0.5
                        PosAutoCorrectionYCoef=0.5
                        Size=243,158
                        Style=Style.Window.2Simple
                    }
                    Window ^{
                        Active=False
                        Image ^{
                            Image=GI,Bm.Items.2Hull_People_R_s
                            Name=img_Radar
                            Pos=16,14,0
                            Size=35,35
                        }
                        Image ^{
                            Image=GI,Bm.FormInfo3.2BRacePeopleN
                            Name=race_Radar
                            Pos=198,121,8
                            Size=35,35
                        }
                        Image ^{
                            Image=GI,Bm.FormNote.2ItemBottomLeft
                            Pos=0,90,10
                            Size=118,69
                        }
                        Image ^{
                            Image=GI,Bm.FormNote.2ItemBottomRight
                            Pos=130,90,10
                            Size=122,69
                        }
                        Image ^{
                            Image=GI,Bm.FormNote.2ItemBottomRight
                            Pos=115,90,10
                            Size=20,69
                        }
                        Label ^{
                            AlignX=Center
                            AlignY=CenterEx
                            Font=Font.2SmallBold
                            Name=name_Radar
                            Pos=60,13,8
                            Size=165,40
                            TextColor=57,239,255
                            WordWrap=True
                        }
                        Label ^{
                            AlignX=Center
                            AlignY=CenterEx
                            Font=Font.2Small
                            Name=text_Radar
                            Pos=15,45,8
                            Size=210,83
                            TextColor=255,255,255
                            WordWrap=True
                        }
                        Label ^{
                            AlignX=Left
                            AlignY=CenterEx
                            Font=Font.2Normal
                            Name=size_Radar
                            Pos=49,121,8
                            Size=45,33
                            TextColor=255,255,255
                            WordWrap=True
                        }
                        Label ^{
                            AlignX=Left
                            AlignY=CenterEx
                            Font=Font.2Normal
                            Name=cost_Radar
                            Pos=117,121,8
                            Size=100,33
                            TextColor=255,255,255
                            WordWrap=True
                        }
                        Name=w_Radar
                        Pos=740,390,4
                        PosAutoCorrection=True
                        PosAutoCorrectionXCoef=0.5
                        PosAutoCorrectionYCoef=0.5
                        Size=243,158
                        Style=Style.Window.2Simple
                    }
                    Window ^{
                        Active=False
                        Image ^{
                            Image=GI,Bm.Items.2Hull_People_R_s
                            Name=img_CargoHook
                            Pos=16,14,0
                            Size=35,35
                        }
                        Image ^{
                            Image=GI,Bm.FormInfo3.2BRacePeopleN
                            Name=race_CargoHook
                            Pos=198,121,8
                            Size=35,35
                        }
                        Image ^{
                            Image=GI,Bm.FormNote.2ItemBottomLeft
                            Pos=0,90,10
                            Size=118,69
                        }
                        Image ^{
                            Image=GI,Bm.FormNote.2ItemBottomRight
                            Pos=130,90,10
                            Size=122,69
                        }
                        Image ^{
                            Image=GI,Bm.FormNote.2ItemBottomRight
                            Pos=115,90,10
                            Size=20,69
                        }
                        Label ^{
                            AlignX=Center
                            AlignY=CenterEx
                            Font=Font.2SmallBold
                            Name=name_CargoHook
                            Pos=60,13,8
                            Size=165,40
                            TextColor=57,239,255
                            WordWrap=True
                        }
                        Label ^{
                            AlignX=Center
                            AlignY=CenterEx
                            Font=Font.2Small
                            Name=text_CargoHook
                            Pos=10,45,8
                            Size=220,83
                            TextColor=255,255,255
                            WordWrap=True
                        }
                        Label ^{
                            AlignX=Left
                            AlignY=CenterEx
                            Font=Font.2Normal
                            Name=size_CargoHook
                            Pos=49,121,8
                            Size=45,33
                            TextColor=255,255,255
                            WordWrap=True
                        }
                        Label ^{
                            AlignX=Left
                            AlignY=CenterEx
                            Font=Font.2Normal
                            Name=cost_CargoHook
                            Pos=117,121,8
                            Size=100,33
                            TextColor=255,255,255
                            WordWrap=True
                        }
                        Name=w_CargoHook
                        Pos=127,535,4
                        PosAutoCorrection=True
                        PosAutoCorrectionXCoef=0.5
                        PosAutoCorrectionYCoef=0.5
                        Size=243,158
                        Style=Style.Window.2Simple
                    }
                    Window ^{
                        Active=False
                        Image ^{
                            Image=GI,Bm.Items.2Hull_People_R_s
                            Name=img_DefGenerator
                            Pos=16,14,0
                            Size=35,35
                        }
                        Image ^{
                            Image=GI,Bm.FormInfo3.2BRacePeopleN
                            Name=race_DefGenerator
                            Pos=198,121,8
                            Size=35,35
                        }
                        Image ^{
                            Image=GI,Bm.FormNote.2ItemBottomLeft
                            Pos=0,90,10
                            Size=118,69
                        }
                        Image ^{
                            Image=GI,Bm.FormNote.2ItemBottomRight
                            Pos=130,90,10
                            Size=122,69
                        }
                        Image ^{
                            Image=GI,Bm.FormNote.2ItemBottomRight
                            Pos=115,90,10
                            Size=20,69
                        }
                        Label ^{
                            AlignX=Center
                            AlignY=CenterEx
                            Font=Font.2SmallBold
                            Name=name_DefGenerator
                            Pos=60,13,8
                            Size=165,40
                            TextColor=57,239,255
                            WordWrap=True
                        }
                        Label ^{
                            AlignX=Center
                            AlignY=CenterEx
                            Font=Font.2Small
                            Name=text_DefGenerator
                            Pos=15,45,8
                            Size=210,83
                            TextColor=255,255,255
                            WordWrap=True
                        }
                        Label ^{
                            AlignX=Left
                            AlignY=CenterEx
                            Font=Font.2Normal
                            Name=size_DefGenerator
                            Pos=49,121,8
                            Size=45,33
                            TextColor=255,255,255
                            WordWrap=True
                        }
                        Label ^{
                            AlignX=Left
                            AlignY=CenterEx
                            Font=Font.2Normal
                            Name=cost_DefGenerator
                            Pos=117,121,8
                            Size=100,33
                            TextColor=255,255,255
                            WordWrap=True
                        }
                        Name=w_DefGenerator
                        Pos=617,535,4
                        PosAutoCorrection=True
                        PosAutoCorrectionXCoef=0.5
                        PosAutoCorrectionYCoef=0.5
                        Size=243,158
                        Style=Style.Window.2Simple
                    }
                    Window ^{
                        Active=False
                        Image ^{
                            Image=GI,Bm.Items.2Hull_People_R_s
                            Name=img_RepairRobot
                            Pos=16,14,0
                            Size=35,35
                        }
                        Image ^{
                            Image=GI,Bm.FormInfo3.2BRacePeopleN
                            Name=race_RepairRobot
                            Pos=198,121,8
                            Size=35,35
                        }
                        Image ^{
                            Image=GI,Bm.FormNote.2ItemBottomLeft
                            Pos=0,90,10
                            Size=118,69
                        }
                        Image ^{
                            Image=GI,Bm.FormNote.2ItemBottomRight
                            Pos=130,90,10
                            Size=122,69
                        }
                        Image ^{
                            Image=GI,Bm.FormNote.2ItemBottomRight
                            Pos=115,90,10
                            Size=20,69
                        }
                        Label ^{
                            AlignX=Center
                            AlignY=CenterEx
                            Font=Font.2SmallBold
                            Name=name_RepairRobot
                            Pos=60,13,8
                            Size=165,40
                            TextColor=57,239,255
                            WordWrap=True
                        }
                        Label ^{
                            AlignX=Center
                            AlignY=CenterEx
                            Font=Font.2Small
                            Name=text_RepairRobot
                            Pos=0,45,8
                            Size=240,83
                            TextColor=255,255,255
                            WordWrap=True
                        }
                        Label ^{
                            AlignX=Left
                            AlignY=CenterEx
                            Font=Font.2Normal
                            Name=size_RepairRobot
                            Pos=49,121,8
                            Size=45,33
                            TextColor=255,255,255
                            WordWrap=True
                        }
                        Label ^{
                            AlignX=Left
                            AlignY=CenterEx
                            Font=Font.2Normal
                            Name=cost_RepairRobot
                            Pos=117,121,8
                            Size=100,33
                            TextColor=255,255,255
                            WordWrap=True
                        }
                        Name=w_RepairRobot
                        Pos=372,535,4
                        PosAutoCorrection=True
                        PosAutoCorrectionXCoef=0.5
                        PosAutoCorrectionYCoef=0.5
                        Size=243,158
                        Style=Style.Window.2Simple
                    }
                    Window ^{
                        Active=False
                        Label ^{
                            AlignX=Left
                            AlignY=Center
                            Font=Font.2SmallBold
                            Name=Ship_name_stat
                            Pos=100,13
                            Size=200,25
                            Text=1-------------0
                            TextColor=57,239,255
                            WordWrap=True
                        }
                        Name=Stat_window
                        Panel ^{
                            Label ^{
                                AlignX=Left
                                AlignY=Top
                                Font=Font.2Small
                                Pos=15,68
                                Size=250,25
                                Text=Ship Experience:
                                TextColor=255,255,255
                                WordWrap=True
                            }
                            Label ^{
                                AlignX=Left
                                AlignY=Top
                                Font=Font.2Small
                                Pos=20,80
                                Size=250,25
                                Text=- from killing dominators:
                                TextColor=255,255,255
                                WordWrap=True
                            }
                            Label ^{
                                AlignX=Left
                                AlignY=Top
                                Font=Font.2Small
                                Pos=20,92
                                Size=250,25
                                Text=- from killing pirates:
                                TextColor=255,255,255
                                WordWrap=True
                            }
                            Label ^{
                                AlignX=Left
                                AlignY=Top
                                Font=Font.2Small
                                Pos=20,104
                                Size=250,25
                                Text=- from other killings:
                                TextColor=255,255,255
                                WordWrap=True
                            }
                            Label ^{
                                AlignX=Left
                                AlignY=Top
                                Font=Font.2Small
                                Pos=20,116
                                Size=250,25
                                Text=- from trade:
                                TextColor=255,255,255
                                WordWrap=True
                            }
                            Label ^{
                                AlignX=Left
                                AlignY=Top
                                Font=Font.2Small
                                Pos=20,128
                                Size=250,25
                                Text=- other experience:
                                TextColor=255,255,255
                                WordWrap=True
                            }
                            Label ^{
                                AlignX=Right
                                AlignY=Top
                                Font=Font.2Small
                                Name=exp_str
                                Pos=170,68
                                Size=100,100
                                TextColor=255,255,255
                                WordWrap=True
                            }
                            Pos=0,0
                            Size=310,387
                        }
                        Panel ^{
                            Label ^{
                                AlignX=Left
                                AlignY=Top
                                Font=Font.2Small
                                Pos=0,0
                                Size=250,25
                                Text=Ships destroyed:
                                TextColor=255,255,255
                                WordWrap=True
                            }
                            Label ^{
                                AlignX=Left
                                AlignY=Top
                                Font=Font.2Small
                                Pos=10,12
                                Size=250,25
                                Text=- pirates:
                                TextColor=255,255,255
                                WordWrap=True
                            }
                            Label ^{
                                AlignX=Left
                                AlignY=Top
                                Font=Font.2Small
                                Pos=10,24
                                Size=250,25
                                Text=- dominators:
                                TextColor=255,255,255
                                WordWrap=True
                            }
                            Label ^{
                                AlignX=Left
                                AlignY=Top
                                Font=Font.2Small
                                Pos=10,36
                                Size=250,25
                                Text=- civilians:
                                TextColor=255,255,255
                                WordWrap=True
                            }
                            Label ^{
                                AlignX=Left
                                AlignY=Top
                                Font=Font.2Small
                                Pos=10,48
                                Size=250,25
                                Text=- militaries:
                                TextColor=255,255,255
                                WordWrap=True
                            }
                            Label ^{
                                AlignX=Left
                                AlignY=Top
                                Font=Font.2Small
                                Pos=10,60
                                Size=250,25
                                Text=- rangers:
                                TextColor=255,255,255
                                WordWrap=True
                            }
                            Label ^{
                                AlignX=Right
                                AlignY=Top
                                Font=Font.2Small
                                Name=kill_ship_str
                                Pos=160,0
                                Size=100,100
                                TextColor=255,255,255
                                WordWrap=True
                            }
                            Pos=10,148
                            Size=310,387
                        }
                        Panel ^{
                            Label ^{
                                AlignX=Left
                                AlignY=Top
                                Font=Font.2Small
                                Pos=0,0
                                Size=250,25
                                Text=Quests completed:
                                TextColor=255,255,255
                                WordWrap=True
                            }
                            Label ^{
                                AlignX=Left
                                AlignY=Top
                                Font=Font.2Small
                                Pos=10,12
                                Size=250,25
                                Text=- cargo delivery:
                                TextColor=255,255,255
                                WordWrap=True
                            }
                            Label ^{
                                AlignX=Left
                                AlignY=Top
                                Font=Font.2Small
                                Pos=10,24
                                Size=250,25
                                Text=- ship killing:
                                TextColor=255,255,255
                                WordWrap=True
                            }
                            Label ^{
                                AlignX=Left
                                AlignY=Top
                                Font=Font.2Small
                                Pos=10,36
                                Size=250,25
                                Text=- text quests:
                                TextColor=255,255,255
                                WordWrap=True
                            }
                            Label ^{
                                AlignX=Left
                                AlignY=Top
                                Font=Font.2Small
                                Pos=10,48
                                Size=250,25
                                Text=- systems protection:
                                TextColor=255,255,255
                                WordWrap=True
                            }
                            Label ^{
                                AlignX=Left
                                AlignY=Top
                                Font=Font.2Small
                                Pos=10,60
                                Size=250,25
                                Text=- ship protection:
                                TextColor=255,255,255
                                WordWrap=True
                            }
                            Label ^{
                                AlignX=Left
                                AlignY=Top
                                Font=Font.2Small
                                Pos=10,72
                                Size=250,25
                                Text=- planetary battles:
                                TextColor=255,255,255
                                WordWrap=True
                            }
                            Label ^{
                                AlignX=Right
                                AlignY=Top
                                Font=Font.2Small
                                Name=quest_str
                                Pos=160,0
                                Size=100,100
                                TextColor=255,255,255
                                WordWrap=True
                            }
                            Pos=10,228
                            Size=310,387
                        }
                        Panel ^{
                            Label ^{
                                AlignX=Left
                                AlignY=Top
                                Font=Font.2Small
                                Pos=0,0
                                Size=250,25
                                Text=Ships destroyed in the system:
                                TextColor=255,255,255
                                WordWrap=True
                            }
                            Label ^{
                                AlignX=Left
                                AlignY=Top
                                Font=Font.2Small
                                Pos=10,12
                                Size=250,25
                                Text=- coalition ships:
                                TextColor=255,255,255
                                WordWrap=True
                            }
                            Label ^{
                                AlignX=Left
                                AlignY=Top
                                Font=Font.2Small
                                Pos=10,24
                                Size=250,25
                                Text=- dominator ships:
                                TextColor=255,255,255
                                WordWrap=True
                            }
                            Label ^{
                                AlignX=Left
                                AlignY=Top
                                Font=Font.2Small
                                Pos=10,36
                                Size=250,25
                                Text=- clan ships:
                                TextColor=255,255,255
                                WordWrap=True
                            }
                            Label ^{
                                AlignX=Right
                                AlignY=Top
                                Font=Font.2Small
                                Name=kill_ship_star_str
                                Pos=160,12
                                Size=100,100
                                TextColor=255,255,255
                                WordWrap=True
                            }
                            Pos=10,320
                            Size=310,387
                        }
                        Panel ^{
                            Label ^{
                                AlignX=Left
                                AlignY=Top
                                Font=Font.2Small
                                Pos=0,0
                                Size=250,25
                                Text=Galaxy Tech Level:
                                TextColor=255,255,255
                                WordWrap=True
                            }
                            Label ^{
                                AlignX=Right
                                AlignY=Top
                                Font=Font.2Small
                                Name=GTU_stat
                                Pos=156,0
                                Size=100,100
                                TextColor=255,255,255
                                WordWrap=True
                            }
                            Pos=10,376
                            Size=310,20
                        }
                        Pos=150,100
                        PosAutoCorrection=True
                        PosAutoCorrectionXCoef=1
                        PosAutoCorrectionYCoef=1
                        Size=310,420
                        Style=Style.Window.2Simple
                    }
                }
            }
        }
    }
    StarMap ^{
        Panel ^{
            Panel ^{
                Assistant ^{
                    Panel ^{
                        Active=True
                        GraphButton ^{
                            Active=True
                            ImageDown=GI,Bm.FormAst.2AstShipSearchD
                            ImageNormal=GI,Bm.FormAst.2AstShipSearchN
                            ImageNormalA=GI,Bm.FormAst.2AstShipSearchA
                            Kind=Normal
                            KindHit=Graph
                            MouseBlocking=True
                            MouseBlockingTest=False
                            Name=AstShipSearch
                            OnPressCode ^{
                                0=str ship_name = '';
                                0=str br = substr(CT('FormScore.DateWin'), 5, 2);
                                0=str location='';
                                0=str ether_str='';
                                0=str temp_str='';
                                1=unknown ship_array=newarray(1);
                                1=int i=0;
                                1=int j=0;
                                1=int k=0;
                                1=int page=0;
                                1=dword ship=0;
                                1=dword star=0;
                                2=ship_name=TextBox('Enter ship name:');
                                2=ship_name=lowercase(ship_name);
                                2=if(ship_name=='')exit;
                                3=for(i=0;i<GalaxyStars();i=i+1)
                                3 ^{
                                    01=star=StarNearbyStars(ShipStar(Player()),i);
                                    02=for(j=0;j<StarShips(star);j=j+1)
                                    03 ^{
                                        01=ship=StarShips(star,j);
                                        02=if(CT('AssistantExclusions.'+ShipType(ship))=='NoSearch')continue;
                                        03=if(findsubstr(lowercase(Name(ship)),ship_name)>=0)ArrayAdd(ship_array,ship);
                                    }
                                    04=for(j=0;j<StarPlanets(star);j=j+1)
                                    05 ^{
                                        01=if(PlanetOwner(StarPlanets(star,j))<5)continue;
                                        02=for(k=0;k<PlanetWarriors(StarPlanets(star,j));k=k+1)
                                        03 ^{
                                            01=ship=PlanetWarriors(StarPlanets(star,j),k);
                                            02=if(CT('AssistantExclusions.'+ShipType(ship))=='NoSearch')continue;
                                            03=if(findsubstr(lowercase(ShipName(ship)),ship_name)>=0)ArrayAdd(ship_array,ship);
                                        }
                                    }
                                }
                                4=if(ArrayDim(ship_array)<2)MessageBox('Ship not found.');
                                5=if(ArrayDim(ship_array)>1)
                                5 ^{
                                    0=for(i=1;i<ArrayDim(ship_array);i=i+1)
                                    0 ^{
                                        0=page=page+1;
                                        0=ship=ship_array[i];
                                        0=if(GetShipPlanet(ship)>0)location='planet '+'<color=255,240,100>'+Name(GetShipPlanet(ship))+'</color>';
                                        0=if(GetShipRuins(ship)>0)location=CT('ShipType.TypeName.'+ShipType(GetShipRuins(ship))+'Small')+' <color=255,240,100> '+ShipName(GetShipRuins(ship))+'</color>';
                                        0=if(ShipInHyperSpace(ship))location='in hyperspace';
                                        0=if(ShipInNormalSpace(ship))location='outer space';
                                        1=if(ObjectType(ship)==4)temp_str=CT('ShipType.TypeName.'+ShipType(ship)+'Small')+' '+ShipName(ship);
                                        1=if(ObjectType(ship)!=4)temp_str=Name(ship);
                                        1=ether_str=ether_str+temp_str;
                                        2=temp_str='<color=255,240,100>'+Name(ShipStar(ship))+'</color>';
                                        2=ether_str=ether_str+' '+temp_str;
                                        3=temp_str='<color=255,240,100>'+Name(StarToCon(ShipStar(ship)))+'</color>';
                                        3=ether_str=ether_str+'('+temp_str+')';
                                        4=ether_str=ether_str+', '+location+br;
                                        5=if(page>30)
                                        5 ^{
                                            0=Ether(7,'find_ship_ether_'+i,ether_str);
                                            1=page=0;
                                            2=ether_str='';
                                        }
                                    }
                                    1=Ether(7,'find_ship_ether_'+i,ether_str);
                                    2=FormChange('StarMap');
                                }
                            }
                            Pos=17,4,0
                            Size=43,33
                            Style=Style.GB.SoundNormal
                        }
                        GraphButton ^{
                            Active=True
                            ImageDown=GI,Bm.FormAst.2AstEquipSearchD
                            ImageNormal=GI,Bm.FormAst.2AstEquipSearchN
                            ImageNormalA=GI,Bm.FormAst.2AstEquipSearchA
                            Kind=Normal
                            KindHit=Graph
                            MouseBlocking=True
                            MouseBlockingTest=False
                            Name=AstEquipSearch
                            OnPressCode ^{
                                0=str br=substr(CT('FormScore.DateWin'),5,2);
                                0=str ether_str='';
                                0=str temp_str='';
                                0=str item_name='';
                                1=int i=0;
                                1=int j=0;
                                1=int k=0;
                                1=int item_size=-1;
                                1=int page=0;
                                1=dword ship=0;
                                1=dword star=0;
                                1=dword item=0;
                                1=int numb=0;
                                1=int item_lvl=0;
                                2=item_name=TextBox('Enter Equipment name:');
                                2=item_name=lowercase(item_name);
                                2=if(item_name=='')exit;
                                2=item_size=TextBox('Maximum weight:');
                                2=if(item_size<=0)exit;
                                2=item_lvl=TextBox('Tech. level no less than:');
                                2=if(item_lvl>8 || item_lvl<1)item_lvl=GalaxyTechLevel();
                                3=for(i=0;i<GalaxyStars();i=i+1)
                                3 ^{
                                    0=star=StarNearbyStars(ShipStar(Player()),i);
                                    1=for(j=0;j<StarShips(star);j=j+1)
                                    1 ^{
                                        0=ship=StarShips(star,j);
                                        01=for(k=0;k<ShipItems(ship);k=k+1)
                                        01 ^{
                                            0=item=ShipItems(ship,k);
                                            1=if(!ItemIsInUse(item))continue;
                                            1=if(ItemSize(item)>item_size)continue;
                                            1=if(ItemLevel(item)<item_lvl)continue;
                                            2=if(findsubstr(lowercase(Name(item)),item_name)>=0)
                                            2 ^{
                                                0=page=page+1;
                                                0=numb=numb+1;
                                                1=if(numb==0)ether_str=ether_str+numb+'. '+Name(item)+', Tech. level: <color=255,240,100>'+ItemLevel(item)+'</color>'+br;
                                                1=if(numb!=0)ether_str=ether_str+br+numb+'. '+Name(item)+', Tech. level: <color=255,240,100>'+ItemLevel(item)+'</color>'+br;
                                                1=ether_str=ether_str+'<td=30>Weight: <color=255,240,100>'+ItemSize(item)+'</color>';
                                                2=if(ItemType(item)<t_Weapon1)
                                                2 ^{
                                                    0=if(ItemType(item)==t_Engine)ether_str=ether_str+', speed: <color=255,240,100>'+GetEquipmentStats(item,0)+'</color>'+', jump range: <color=255,240,100>'+GetEquipmentStats(item,1)+'</color>'+br;
                                                    0=if(ItemType(item)==t_CargoHook)ether_str=ether_str+', power: <color=255,240,100>'+GetEquipmentStats(item,0)+'</color>'+', range: <color=255,240,100>'+GetEquipmentStats(item,1)+'</color>'+br;
                                                    0=if(ItemType(item)==t_Hull)ether_str=ether_str+', armor: <color=255,240,100>'+GetEquipmentStats(item,0)+'</color>'+br;
                                                    0=if(ItemType(item)==t_FuelTanks)ether_str=ether_str+', capacity: <color=255,240,100>'+GetEquipmentStats(item,0)+'</color>'+br;
                                                    0=if(ItemType(item)==t_Radar)ether_str=ether_str+', range: <color=255,240,100>'+GetEquipmentStats(item,0)+'</color>'+br;
                                                    0=if(ItemType(item)==t_Scaner)ether_str=ether_str+', scanner: <color=255,240,100>'+GetEquipmentStats(item,0)+'</color>'+br;
                                                    0=if(ItemType(item)==t_RepairRobot)ether_str=ether_str+', repairs: <color=255,240,100>'+GetEquipmentStats(item,0)+'</color>'+br;
                                                    0=if(ItemType(item)==t_DefGenerator)ether_str=ether_str+', defense: <color=255,240,100>'+GetEquipmentStats(item,0)+'</color>'+'%'+br;
                                                }
                                                3=if(ItemType(item)>t_DefGenerator)ether_str=ether_str+', damage: <color=255,240,100>'+GetEquipmentStats(item,1)+'-'+GetEquipmentStats(item,0)+'</color>'+', radius: <color=255,240,100>'+GetEquipmentStats(item,2)+'</color>'+br;
                                                4=ether_str=ether_str+'<td=30>'+Name(ship)+' <color=255,240,100>'+Name(ShipStar(ship))+'('+Name(StarToCon(ShipStar(ship)))+')</color>';
                                                5=if(page>15)
                                                5 ^{
                                                    0=Ether(7,'find_ship_ether_'+numb,ether_str);
                                                    1=page=1;
                                                    2=ether_str='';
                                                }
                                            }
                                        }
                                    }
                                }
                                4=if(!numb) MessageBox('Item not found.');
                                5=else
                                5 ^{
                                    01=if(ether_str != '') Ether(7, 'find_item_ether_' + i, ether_str);
                                    02=FormChange('StarMap');
                                }
                            }
                            Pos=17,37,1
                            Size=43,32
                            Style=Style.GB.SoundNormal
                        }
                        GraphButton ^{
                            Active=True
                            ImageDown=GI,Bm.FormAst.2AstRCChainD
                            ImageNormal=GI,Bm.FormAst.2AstRCChainN
                            ImageNormalA=GI,Bm.FormAst.2AstRCChainA
                            Kind=Normal
                            KindHit=Graph
                            MouseBlocking=True
                            MouseBlockingTest=False
                            Name=AstRCChain
                            OnPressCode ^{
                                01=int i, k, l, m, j, n, bon, may_add_end, c_ruin, may_add;
                                02=dword ruin, item, star;
                                03=str mm_name_color, mm_color, mm_name, mm_text;
                                04=str br = substr(CT('FormScore.DateWin'), 5, 2);
                                05=unknown mm_array = newarray(1);
                                06=unknown ruin_array_name = newarray(1);
                                07=unknown ruin_array = newarray(1);
                                08=unknown mm_array_1 = newarray(1);
                                09=unknown mm_array_2 = newarray(1);
                                10=unknown mm_array_3 = newarray(1);
                                11=for(i = 0; i < GalaxyStars(); i = i + 1)
                                12 ^{
                                    01=star = StarNearbyStars(ShipStar(Player()), i);
                                    02=if(StarOwner(star) != 0 && StarOwner(star) != 2) continue;
                                    03=if(StarCustomFaction(star) != '') continue;
                                    04=for(j = 0; j < StarRuins(star); j = j + 1)
                                    05 ^{
                                        01=ruin = StarRuins(star, j);
                                        02=if(ShipType(ruin) != 'RC' && (ShipType(ruin) != 'CB' || !IsScriptActive('Mod_ExpCB'))) continue;
                                        03=mm_text = ruin + ' (' + Name(star) + ')';
                                        04=ArrayAdd(ruin_array, ruin);
                                        05=if(ShipTypeN(ruin) == t_RC) ArrayAdd(ruin_array_name, 'RC ' + ShipName(ruin) + ' (' + Name(star) + ')');
                                        06=else ArrayAdd(ruin_array_name, 'dom. ' + ShipName(ruin) + ' (' + Name(star) + ')');
                                    }
                                }
                                13=ruin = 0;
                                14=if(ArrayDim(ruin_array) > 1)
                                15 ^{
                                    01=if(ArrayDim(ruin_array) > 2)
                                    02 ^{
                                        01=ArrayAdd(ruin_array_name, 'Information for all (main.)');
                                        02=ArrayAdd(ruin_array_name, 'Information for all (alternative.)');
                                    }
                                    03=if(ArrayDim(ruin_array) == 2)
                                    04 ^{
                                        01=ArrayAdd(ruin_array_name, 'Alternative chain');
                                    }
                                    05=c_ruin = ListBox('Chain stations:', ruin_array_name);
                                    06=if(c_ruin > 0)
                                    07 ^{
                                        01=if(c_ruin < ArrayDim(ruin_array))
                                        02 ^{
                                            01=ruin = ruin_array[c_ruin];
                                            02=ArrayClear(ruin_array);
                                            03=ArrayAdd(ruin_array, ruin);
                                            04=ruin = 100;
                                        }
                                        02=else
                                        03 ^{
                                            01=if(ArrayDim(ruin_array) > 2)
                                            02 ^{
                                                01=if(c_ruin - ArrayDim(ruin_array) == 0) ruin = 100;
                                                02=if(c_ruin - ArrayDim(ruin_array) == 1) ruin = 101;
                                                03=if(c_ruin - ArrayDim(ruin_array) == 2) ruin = 102;
                                            }
                                            03=else if(ArrayDim(ruin_array) == 2)
                                            04 ^{
                                                01=if(c_ruin - ArrayDim(ruin_array) == 0) ruin = 101;
                                                02=if(c_ruin - ArrayDim(ruin_array) == 1) ruin = 102;
                                            }
                                        }
                                    }
                                }
                                16=if(ArrayDim(ruin_array) == 1) MessageBox('No suitable station found.');
                                17=if(ArrayDim(ruin_array) == 1 || c_ruin < 0) exit;
                                18=for(i = 0; i < ShipItems(Player()); i = i + 1)
                                19 ^{
                                    01=item = ShipItems(Player(), i);
                                    02=if(ItemType(item) != t_MicroModule) continue;
                                    03=if(BonusIsSpecial(EqModule(item))) continue;
                                    04=l = 0;
                                    05=for(j = 1; j < ArrayDim(mm_array); j = j + 1)
                                    06 ^{
                                        01=if(EqModule(item) != mm_array[j])
                                        02 ^{
                                            01=l = 1;
                                            02=break;
                                        }
                                    }
                                    07=if(ArrayDim(mm_array) == 1) ArrayAdd(mm_array, EqModule(item));
                                    08=if(l) ArrayAdd(mm_array, EqModule(item));
                                }
                                20=if(ruin == 100)
                                21 ^{
                                    01=for(m = 1; m < ArrayDim(ruin_array); m = m + 1)
                                    02 ^{
                                        01=ruin = ruin_array[m];
                                        02=ArrayClear(mm_array_1);
                                        03=ArrayClear(mm_array_2);
                                        04=ArrayClear(mm_array_3);
                                        05=for(i = 0; i <= 2; i = i + 1)
                                        06 ^{
                                            01=if(i == 2) mm_color = '<color=255,0,0>';
                                            02=else if(i == 1) mm_color = '<color=255,240,100>';
                                            03=else mm_color = '<color=17,139,255>';
                                            04=mm_text = '';
                                            05=may_add_end = 0;
                                            06=l = 0;
                                            07=while(l <= 50)
                                            08 ^{
                                                01=may_add = 0;
                                                02=for(n = 0; n < ShipItems(Player()); n = n + 1)
                                                03 ^{
                                                    01=item = ShipItems(Player(), n);
                                                    02=bon = RuinsMicromoduleChain(ruin, i, l);
                                                    03=if(ItemType(item) < t_Hull) continue;
                                                    04=if(ItemType(item) > t_CustomWeapon) continue;
                                                    05=if(~EqModule(item)) continue;
                                                    06=if(MayAddBonusToEq(bon, item))
                                                    07 ^{
                                                        01=may_add = 1;
                                                        02=break;
                                                    }
                                                }
                                                04=for(k = 1; k < ArrayDim(mm_array); k = k + 1)
                                                05 ^{
                                                    01=if(mm_array[k] == bon) may_add = 0;
                                                }
                                                06=if(may_add || (l == 50 && !may_add_end))
                                                07 ^{
                                                    01=mm_name_color = mm_color;
                                                    02=may_add_end = 1;
                                                }
                                                08=else mm_name_color = '<color=123,123,123>';
                                                09=mm_name = mm_name_color + BonusName(bon) + '</color>';
                                                10=if(i == 2) ArrayAdd(mm_array_1, mm_name);
                                                11=else if(i == 1) ArrayAdd(mm_array_2, mm_name);
                                                12=else ArrayAdd(mm_array_3, mm_name);
                                                13=l = l + 1;
                                            }
                                        }
                                        07=if(ShipTypeN(ruin) == t_RC) mm_text = '<td=50>Micromodules in the main chain on <color=255,240,100>RC ' + ShipName(ruin) + '</color>' + br;
                                        08=else mm_text = '<td=38>Micromodules in the main chain on <color=255,240,100>dominion ' + ShipName(ruin) + '</color>' + br;
                                        09=mm_text = mm_text + '--------------------------------------------------------------------------------------------------' + br;
                                        10=for(i = 1; i <= 48; i = i + 1)
                                        11 ^{
                                            01=if(i <= 9) mm_text = mm_text + '<td=18>' + i + '. ' + mm_array_1[i] + '<td=178>' + i + '. ' + mm_array_2[i] + '</td>' + '<td=328>' + i + '. ' + mm_array_3[i] + br;
                                            02=else mm_text = mm_text + '<td=10>' + i + '. ' + mm_array_1[i] + '<td=170>' + i + '. ' + mm_array_2[i] + '</td>' + '<td=320>' + i + '. ' + mm_array_3[i] + br;
                                        }
                                        12=Ether(7, '', mm_text);
                                    }
                                }
                                22=else if(ruin == 101)
                                23 ^{
                                    01=for(m = 1; m < ArrayDim(ruin_array); m = m + 1)
                                    02 ^{
                                        01=ruin = ruin_array[m];
                                        02=ArrayClear(mm_array_1);
                                        03=ArrayClear(mm_array_2);
                                        04=for(i = 0; i <= 1; i = i + 1)
                                        05 ^{
                                            01=mm_text = '';
                                            02=l = 0;
                                            03=while(l <= 50)
                                            04 ^{
                                                01=may_add = 0;
                                                02=for(n = 0; n < ShipItems(Player()); n = n + 1)
                                                03 ^{
                                                    01=item = ShipItems(Player(), n);
                                                    02=bon = RuinsMicromoduleChain(ruin, 2, l, i);
                                                    03=if(ItemType(item) < t_Hull) continue;
                                                    04=if(ItemType(item) > t_CustomWeapon) continue;
                                                    05=if(~EqModule(item)) continue;
                                                    06=if(MayAddBonusToEq(bon, item))
                                                    07 ^{
                                                        01=may_add = 1;
                                                        02=break;
                                                    }
                                                }
                                                04=for(k = 1; k < ArrayDim(mm_array); k = k + 1)
                                                05 ^{
                                                    01=if(mm_array[k] == bon) may_add = 0;
                                                }
                                                06=if(may_add || (l == 50 && !may_add_end))
                                                07 ^{
                                                    01=if(i) mm_name_color = '<color=255,0,0>';
                                                    02=else mm_name_color = '<color=195,55,55>';
                                                    03=may_add_end = 1;
                                                }
                                                08=else mm_name_color = '<color=123,123,123>';
                                                09=mm_name = mm_name_color + BonusName(bon) + '</color>';
                                                10=if(i) ArrayAdd(mm_array_2, mm_name);
                                                11=else ArrayAdd(mm_array_1, mm_name);
                                                12=l = l + 1;
                                            }
                                        }
                                        06=if(ShipTypeN(ruin) == t_RC) mm_text = '<td=30>Micromodules in the alternative chain on <color=255,240,100>RC ' + ShipName(ruin) + '</color>' + br;
                                        07=else mm_text = '<td=18>Micromodules in the alternative chain on <color=255,240,100>dominion ' + ShipName(ruin) + '</color>' + br;
                                        08=mm_text = mm_text + '--------------------------------------------------------------------------------------------------' + br;
                                        09=for(i = 1; i <= 48; i = i + 1)
                                        10 ^{
                                            01=if(i <= 9) mm_text = mm_text + '<td=18>' + i + '. ' + mm_array_2[i] + '<td=170>' + ' <color=123,123,123>(' + mm_array_1[i] + ')</color>' + br;
                                            02=else mm_text = mm_text + '<td=10>' + i + '. ' + mm_array_2[i] + '<td=170>' + ' <color=123,123,123>(' + mm_array_1[i] + ')</color>' + br;
                                        }
                                        11=Ether(7, ruin + '-12345-54321-ALT', mm_text);
                                    }
                                }
                                24=FormChange('StarMap');
                            }
                            Pos=17,68,2
                            Size=43,35
                            Style=Style.GB.SoundNormal
                        }
                        Image ^{
                            Image=GI,Bm.FormAst.2AstPanel
                            Pos=0,0,3
                            Size=62,127
                        }
                        Name=AstPanel
                        Pos=-512,148,-10
                        PosAutoCorrection=True
                        PosAutoCorrectionXCoef=-0.5
                        PosAutoCorrectionYCoef=0.5
                        Size=62,127
                    }
                    Panel ^{
                        Active=False
                        GraphButton ^{
                            Active=True
                            ImageDown=GI,Bm.FormAst.2AstForsageD
                            ImageNormal=GI,Bm.FormAst.2AstForsageN
                            ImageNormalA=GI,Bm.FormAst.2AstForsageA
                            Kind=Normal
                            KindHit=Graph
                            MouseBlocking=True
                            MouseBlockingTest=False
                            Name=AstForsage
                            OnPressCode ^{
                                01=if(OrderForsage(Player()))
                                02 ^{
                                    01=OrderForsage(Player(), 0);
                                    02=Sound('Sound.ForsageOff');
                                }
                                03=else
                                04 ^{
                                    01=OrderForsage(Player(), 1);
                                    02=Sound('Sound.ForsageOn');
                                }
                            }
                            Pos=2,8,1
                            Size=43,38
                            Style=Style.GB.SoundNormal
                        }
                        Image ^{
                            Image=GI,Bm.FormAst.2AstForsage
                            Pos=0,0,2
                            Size=62,69
                        }
                        Name=AstPanelTablet
                        Pos=450,205,-10
                        PosAutoCorrection=True
                        PosAutoCorrectionXCoef=0.5
                        PosAutoCorrectionYCoef=0.5
                        Size=62,69
                    }
                    Panel ^{
                        Active=False
                        GraphButton ^{
                            Active=True
                            ImageDown=GI,Bm.FormInfo3.2Scr_BT_UP_D
                            ImageNormal=GI,Bm.FormInfo3.2Scr_BT_UP_N
                            ImageNormalA=GI,Bm.FormInfo3.2Scr_BT_UP_A
                            Kind=Normal
                            KindHit=Graph
                            MouseBlocking=True
                            MouseBlockingTest=False
                            Name=star_map_UP
                            OnPressCode ^{
                                01=StarMapCenterView(StarMapCurPosX(), StarMapCurPosY() - 500);
                            }
                            Pos=45,0,1
                            Size=50,53
                            Style=Style.GB.SoundNormal
                        }
                        GraphButton ^{
                            Active=True
                            ImageDown=GI,Bm.FormInfo3.2Scr_BT_RG_D
                            ImageNormal=GI,Bm.FormInfo3.2Scr_BT_RG_N
                            ImageNormalA=GI,Bm.FormInfo3.2Scr_BT_RG_A
                            Kind=Normal
                            KindHit=Graph
                            MouseBlocking=True
                            MouseBlockingTest=False
                            Name=star_map_RG
                            OnPressCode ^{
                                01=StarMapCenterView(StarMapCurPosX() + 500, StarMapCurPosY());
                            }
                            Pos=90,46,1
                            Size=50,53
                            Style=Style.GB.SoundNormal
                        }
                        GraphButton ^{
                            Active=True
                            ImageDown=GI,Bm.FormInfo3.2Scr_BT_DW_D
                            ImageNormal=GI,Bm.FormInfo3.2Scr_BT_DW_N
                            ImageNormalA=GI,Bm.FormInfo3.2Scr_BT_DW_A
                            Kind=Normal
                            KindHit=Graph
                            MouseBlocking=True
                            MouseBlockingTest=False
                            Name=star_map_DW
                            OnPressCode ^{
                                01=StarMapCenterView(StarMapCurPosX(), StarMapCurPosY() + 500);
                            }
                            Pos=45,93,1
                            Size=50,53
                            Style=Style.GB.SoundNormal
                        }
                        GraphButton ^{
                            Active=True
                            ImageDown=GI,Bm.FormInfo3.2Scr_BT_LF_D
                            ImageNormal=GI,Bm.FormInfo3.2Scr_BT_LF_N
                            ImageNormalA=GI,Bm.FormInfo3.2Scr_BT_LF_A
                            Kind=Normal
                            KindHit=Graph
                            MouseBlocking=True
                            MouseBlockingTest=False
                            Name=star_map_LF
                            OnPressCode ^{
                                01=StarMapCenterView(StarMapCurPosX() - 500, StarMapCurPosY());
                            }
                            Pos=0,46,1
                            Size=50,53
                            Style=Style.GB.SoundNormal
                        }
                        GraphButton ^{
                            Active=True
                            ImageDown=GI,Bm.FormInfo3.2Scr_BT_CT_D
                            ImageNormal=GI,Bm.FormInfo3.2Scr_BT_CT_N
                            ImageNormalA=GI,Bm.FormInfo3.2Scr_BT_CT_A
                            Kind=Normal
                            KindHit=Graph
                            MouseBlocking=True
                            MouseBlockingTest=False
                            Name=star_map_CT
                            OnPressCode ^{
                                01=StarMapCenterView(CoordX(Player()), CoordY(Player()));
                            }
                            Pos=50,53,1
                            Size=40,40
                            Style=Style.GB.SoundNormal
                        }
                        Name=Assist_panel_move_button
                        Pos=348,103,-10
                        PosAutoCorrection=True
                        PosAutoCorrectionXCoef=0.5
                        PosAutoCorrectionYCoef=0.5
                        Size=150,159
                    }
                }
            }
        }
    }
}
